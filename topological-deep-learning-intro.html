<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Topological Deep Learning: A Guided Introduction</title>
<script>
window.MathJax = {
  tex: { inlineMath: [['$','$'],['\\(','\\)']], displayMath: [['$$','$$'],['\\[','\\]']] },
  svg: { fontCache: 'global' }
};
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-svg-full.min.js"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Crimson+Pro:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500&family=JetBrains+Mono:wght@400;500&family=Source+Sans+3:ital,wght@0,300;0,400;0,600;0,700;1,400&display=swap');

:root {
  --bg: #faf8f5;
  --bg-alt: #f0ede8;
  --text: #2a2520;
  --text-muted: #6b6560;
  --accent: #b44a2f;
  --accent2: #2a6b5a;
  --accent3: #3a5a8c;
  --accent4: #8b5a8c;
  --border: #d5d0c8;
  --card: #ffffff;
  --shadow: 0 2px 12px rgba(42,37,32,0.08);
  --shadow-lg: 0 8px 32px rgba(42,37,32,0.12);
}

* { margin: 0; padding: 0; box-sizing: border-box; }

html { scroll-behavior: smooth; font-size: 17px; }

body {
  font-family: 'Crimson Pro', Georgia, serif;
  background: var(--bg);
  color: var(--text);
  line-height: 1.72;
  -webkit-font-smoothing: antialiased;
}

/* --- LAYOUT --- */
.container { max-width: 820px; margin: 0 auto; padding: 0 2rem; }

/* --- HEADER --- */
header {
  background: linear-gradient(175deg, #1a1512 0%, #2a2018 40%, #3a2a1f 100%);
  color: #f0ece6;
  padding: 5rem 2rem 4rem;
  position: relative;
  overflow: hidden;
}
header::before {
  content: '';
  position: absolute; inset: 0;
  background:
    radial-gradient(ellipse 600px 400px at 20% 80%, rgba(180,74,47,0.15), transparent),
    radial-gradient(ellipse 500px 300px at 80% 20%, rgba(42,107,90,0.12), transparent);
}
header .container { position: relative; z-index: 1; }
header h1 {
  font-size: 2.8rem;
  font-weight: 300;
  letter-spacing: -0.02em;
  line-height: 1.2;
  margin-bottom: 1rem;
}
header h1 strong { font-weight: 700; color: #e8a88a; }
header .subtitle {
  font-family: 'Source Sans 3', sans-serif;
  font-size: 1.05rem;
  color: #b0a89e;
  max-width: 560px;
  line-height: 1.6;
}
header .prereq {
  margin-top: 1.5rem;
  padding: 0.8rem 1.2rem;
  background: rgba(255,255,255,0.06);
  border-left: 3px solid var(--accent);
  border-radius: 0 6px 6px 0;
  font-family: 'Source Sans 3', sans-serif;
  font-size: 0.88rem;
  color: #c8c0b8;
}

/* --- NAV / TOC --- */
nav.toc {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 2rem 2.5rem;
  margin: -2rem auto 3rem;
  max-width: 820px;
  position: relative;
  z-index: 2;
  box-shadow: var(--shadow-lg);
}
nav.toc h2 {
  font-family: 'Source Sans 3', sans-serif;
  font-size: 0.8rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.12em;
  color: var(--text-muted);
  margin-bottom: 1rem;
}
nav.toc ol {
  list-style: none;
  counter-reset: toc;
  columns: 2;
  column-gap: 2rem;
}
nav.toc li {
  counter-increment: toc;
  break-inside: avoid;
  margin-bottom: 0.4rem;
}
nav.toc li a {
  font-family: 'Source Sans 3', sans-serif;
  font-size: 0.92rem;
  color: var(--text);
  text-decoration: none;
  display: flex;
  align-items: baseline;
  gap: 0.5rem;
  transition: color 0.2s;
}
nav.toc li a:hover { color: var(--accent); }
nav.toc li a::before {
  content: counter(toc, decimal-leading-zero);
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.75rem;
  color: var(--accent);
  font-weight: 500;
}

/* --- SECTIONS --- */
section {
  margin-bottom: 4rem;
  padding-top: 1rem;
}
section h2 {
  font-size: 1.9rem;
  font-weight: 600;
  margin-bottom: 0.3rem;
  color: var(--text);
  letter-spacing: -0.01em;
}
section h2 .sec-num {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.85rem;
  color: var(--accent);
  display: block;
  margin-bottom: 0.3rem;
  font-weight: 500;
}
section h3 {
  font-size: 1.3rem;
  font-weight: 600;
  margin-top: 2rem;
  margin-bottom: 0.5rem;
  color: var(--text);
}
section h4 {
  font-family: 'Source Sans 3', sans-serif;
  font-size: 1rem;
  font-weight: 700;
  margin-top: 1.5rem;
  margin-bottom: 0.4rem;
  color: var(--accent2);
  text-transform: uppercase;
  letter-spacing: 0.04em;
}

p { margin-bottom: 1rem; }
p + p { margin-top: 0; }

strong { font-weight: 600; }

em { font-style: italic; }

/* --- DEFINITION BOXES --- */
.def-box {
  background: var(--card);
  border: 1px solid var(--border);
  border-left: 4px solid var(--accent);
  border-radius: 0 8px 8px 0;
  padding: 1.5rem 1.8rem;
  margin: 1.5rem 0;
  box-shadow: var(--shadow);
}
.def-box.green { border-left-color: var(--accent2); }
.def-box.blue { border-left-color: var(--accent3); }
.def-box.purple { border-left-color: var(--accent4); }
.def-box .def-label {
  font-family: 'Source Sans 3', sans-serif;
  font-size: 0.75rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  margin-bottom: 0.5rem;
}
.def-box.green .def-label { color: var(--accent2); }
.def-box.blue .def-label { color: var(--accent3); }
.def-box.purple .def-label { color: var(--accent4); }
.def-box .def-label { color: var(--accent); }

/* --- INSIGHT / NOTE BOXES --- */
.insight {
  background: linear-gradient(135deg, #f8f4ee, #f5f0e8);
  border-radius: 8px;
  padding: 1.3rem 1.6rem;
  margin: 1.5rem 0;
  position: relative;
}
.insight::before {
  content: 'üí°';
  position: absolute;
  top: -0.6rem;
  left: 1rem;
  font-size: 1.1rem;
  background: var(--bg);
  padding: 0 0.3rem;
}
.insight.physics::before { content: '‚öõÔ∏è'; }
.insight.warning::before { content: '‚ö†Ô∏è'; }
.insight.key::before { content: 'üîë'; }

.insight p:last-child { margin-bottom: 0; }
.insight strong { color: var(--accent); }

/* --- FIGURES / DIAGRAMS --- */
.figure {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 1.5rem;
  margin: 2rem 0;
  text-align: center;
  box-shadow: var(--shadow);
}
.figure svg { max-width: 100%; height: auto; }
.figure .caption {
  font-family: 'Source Sans 3', sans-serif;
  font-size: 0.85rem;
  color: var(--text-muted);
  margin-top: 1rem;
  text-align: left;
  line-height: 1.5;
}
.figure .caption strong {
  color: var(--text);
  font-weight: 600;
}

/* --- COMPARISON TABLE --- */
.comp-table {
  width: 100%;
  border-collapse: collapse;
  margin: 1.5rem 0;
  font-family: 'Source Sans 3', sans-serif;
  font-size: 0.9rem;
}
.comp-table th {
  background: var(--bg-alt);
  font-weight: 700;
  text-align: left;
  padding: 0.7rem 1rem;
  border-bottom: 2px solid var(--border);
  font-size: 0.8rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--text-muted);
}
.comp-table td {
  padding: 0.6rem 1rem;
  border-bottom: 1px solid var(--border);
  vertical-align: top;
}
.comp-table tr:last-child td { border-bottom: none; }
.comp-table tr:hover td { background: rgba(180,74,47,0.03); }

/* --- MATH DISPLAY --- */
.math-block {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 1.2rem 1.5rem;
  margin: 1.5rem 0;
  overflow-x: auto;
  box-shadow: var(--shadow);
}
.math-block .math-label {
  font-family: 'Source Sans 3', sans-serif;
  font-size: 0.75rem;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.08em;
  margin-bottom: 0.5rem;
}

/* --- STEP-BY-STEP --- */
.steps {
  margin: 1.5rem 0;
  padding-left: 0;
  list-style: none;
  counter-reset: step;
}
.steps li {
  counter-increment: step;
  padding: 0.8rem 0 0.8rem 3rem;
  position: relative;
  border-left: 2px solid var(--border);
  margin-left: 1rem;
}
.steps li:last-child { border-left-color: transparent; }
.steps li::before {
  content: counter(step);
  position: absolute;
  left: -0.85rem;
  top: 0.7rem;
  width: 1.7rem;
  height: 1.7rem;
  background: var(--accent);
  color: white;
  border-radius: 50%;
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.75rem;
  font-weight: 500;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* --- CODE --- */
code {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.85em;
  background: var(--bg-alt);
  padding: 0.15em 0.4em;
  border-radius: 4px;
}

/* --- DIVIDER --- */
.divider {
  border: none;
  height: 1px;
  background: linear-gradient(90deg, transparent, var(--border), transparent);
  margin: 3rem 0;
}

/* --- FOOTER --- */
footer {
  background: #1a1512;
  color: #8a8078;
  padding: 3rem 2rem;
  margin-top: 4rem;
  font-family: 'Source Sans 3', sans-serif;
  font-size: 0.85rem;
  text-align: center;
}
footer a { color: #c8a888; }

/* --- RESPONSIVE --- */
@media (max-width: 700px) {
  html { font-size: 15px; }
  header h1 { font-size: 2rem; }
  nav.toc ol { columns: 1; }
  .container { padding: 0 1.2rem; }
}

/* Diagram color tokens */
.node-v { fill: #e8a88a; stroke: #b44a2f; }
.node-e { fill: #8ec5b6; stroke: #2a6b5a; }
.node-f { fill: #a8c0e0; stroke: #3a5a8c; }
.node-h { fill: #c8a8d0; stroke: #8b5a8c; }
.edge-line { stroke: #6b6560; stroke-width: 1.5; }
.edge-hier { stroke: #b0a89e; stroke-width: 1; stroke-dasharray: 4,3; }
.label-text { font-family: 'Source Sans 3', sans-serif; font-size: 11px; fill: #2a2520; text-anchor: middle; }
.label-sm { font-family: 'Source Sans 3', sans-serif; font-size: 10px; fill: #6b6560; text-anchor: middle; }
.set-region { fill-opacity: 0.08; stroke-width: 1.5; stroke-dasharray: 6,3; }
</style>
</head>
<body>

<!-- ====== HEADER ====== -->
<header>
  <div class="container">
    <h1>A Guided Introduction to<br><strong>Topological Deep Learning</strong></h1>
    <p class="subtitle">
      Background material for reading Hajij et al., "Topological Deep Learning: Going Beyond Graph Data" (2022) ‚Äî from graphs and simplicial complexes to combinatorial complexes and higher-order message passing.
    </p>
    <div class="prereq">
      <strong>Prerequisites assumed:</strong> Graduate-level linear algebra, group theory basics, differential geometry exposure, familiarity with standard deep learning (GNNs, message passing). No algebraic topology background required ‚Äî we build it from scratch.
    </div>
  </div>
</header>

<!-- ====== TABLE OF CONTENTS ====== -->
<nav class="toc container">
  <h2>Contents</h2>
  <ol>
    <li><a href="#sec1">Why Go Beyond Graphs?</a></li>
    <li><a href="#sec2">Graphs as Combinatorial Objects</a></li>
    <li><a href="#sec3">Simplicial Complexes</a></li>
    <li><a href="#sec4">Cell Complexes (CW Complexes)</a></li>
    <li><a href="#sec5">Combinatorial Complexes</a></li>
    <li><a href="#sec6">Signals, Cochains &amp; Feature Spaces</a></li>
    <li><a href="#sec7">Neighborhood &amp; Adjacency</a></li>
    <li><a href="#sec8">Higher-Order Message Passing</a></li>
    <li><a href="#sec9">Hodge Theory &amp; the Laplacian</a></li>
    <li><a href="#sec10">The Architecture Zoo</a></li>
    <li><a href="#sec11">From Topology to Thermal Physics</a></li>
    <li><a href="#sec12">Roadmap to the Full Paper</a></li>
  </ol>
</nav>

<main class="container">

<!-- ============================================================ -->
<!-- SECTION 1 -->
<!-- ============================================================ -->
<section id="sec1">
  <h2><span class="sec-num">01</span>Why Go Beyond Graphs?</h2>

  <p>
    Graph neural networks (GNNs) have been spectacularly successful: molecular property prediction, social network analysis, physics simulation, recommendation systems. But graphs encode only <strong>pairwise relationships</strong> ‚Äî an edge connects exactly two nodes. Many real-world phenomena involve <em>multi-way interactions</em> that are not naturally decomposable into pairs.
  </p>

  <div class="figure">
    <svg viewBox="0 0 700 220" width="700" height="220">
      <!-- Graph (pairwise) -->
      <text x="120" y="20" font-family="Source Sans 3, sans-serif" font-size="13" font-weight="600" fill="#2a2520" text-anchor="middle">Graph (pairwise)</text>
      <circle cx="70" cy="100" r="14" class="node-v" stroke-width="2"/>
      <circle cx="170" cy="70" r="14" class="node-v" stroke-width="2"/>
      <circle cx="170" cy="140" r="14" class="node-v" stroke-width="2"/>
      <circle cx="120" cy="180" r="14" class="node-v" stroke-width="2"/>
      <line x1="70" y1="100" x2="170" y2="70" class="edge-line"/>
      <line x1="70" y1="100" x2="170" y2="140" class="edge-line"/>
      <line x1="170" y1="70" x2="170" y2="140" class="edge-line"/>
      <line x1="70" y1="100" x2="120" y2="180" class="edge-line"/>
      <text x="60" y="105" class="label-text" font-size="10" fill="white" text-anchor="middle">A</text>
      <text x="170" y="75" class="label-text" font-size="10" fill="white" text-anchor="middle">B</text>
      <text x="170" y="145" class="label-text" font-size="10" fill="white" text-anchor="middle">C</text>
      <text x="120" y="185" class="label-text" font-size="10" fill="white" text-anchor="middle">D</text>

      <!-- Arrow -->
      <text x="270" y="110" font-family="Source Sans 3, sans-serif" font-size="24" fill="#b0a89e" text-anchor="middle">‚Üí</text>

      <!-- Simplicial complex (with filled triangle) -->
      <text x="430" y="20" font-family="Source Sans 3, sans-serif" font-size="13" font-weight="600" fill="#2a2520" text-anchor="middle">Simplicial Complex</text>
      <polygon points="370,100 470,70 470,140" fill="#a8c0e0" fill-opacity="0.3" stroke="#3a5a8c" stroke-width="1.5"/>
      <line x1="370" y1="100" x2="470" y2="70" class="edge-line" stroke="#2a6b5a"/>
      <line x1="370" y1="100" x2="470" y2="140" class="edge-line" stroke="#2a6b5a"/>
      <line x1="470" y1="70" x2="470" y2="140" class="edge-line" stroke="#2a6b5a"/>
      <line x1="370" y1="100" x2="420" y2="180" class="edge-line" stroke="#2a6b5a"/>
      <circle cx="370" cy="100" r="14" class="node-v" stroke-width="2"/>
      <circle cx="470" cy="70" r="14" class="node-v" stroke-width="2"/>
      <circle cx="470" cy="140" r="14" class="node-v" stroke-width="2"/>
      <circle cx="420" cy="180" r="14" class="node-v" stroke-width="2"/>
      <text x="430" y="112" class="label-sm" fill="#3a5a8c" font-weight="600">2-cell</text>

      <!-- Arrow -->
      <text x="550" y="110" font-family="Source Sans 3, sans-serif" font-size="24" fill="#b0a89e" text-anchor="middle">‚Üí</text>

      <!-- Combinatorial complex (with non-triangular higher cell) -->
      <text x="650" y="20" font-family="Source Sans 3, sans-serif" font-size="13" font-weight="600" fill="#2a2520" text-anchor="middle">Combinatorial Complex</text>
      <path d="M 590,95 Q 620,50 670,65 Q 700,90 690,130 Q 660,160 620,150 Q 590,130 590,95 Z" fill="#c8a8d0" fill-opacity="0.25" stroke="#8b5a8c" stroke-width="1.5"/>
      <line x1="600" y1="90" x2="670" y2="65" class="edge-line" stroke="#2a6b5a"/>
      <line x1="600" y1="90" x2="640" y2="150" class="edge-line" stroke="#2a6b5a"/>
      <line x1="670" y1="65" x2="690" y2="125" class="edge-line" stroke="#2a6b5a"/>
      <line x1="690" y1="125" x2="640" y2="150" class="edge-line" stroke="#2a6b5a"/>
      <line x1="600" y1="90" x2="620" y2="190" class="edge-line" stroke="#2a6b5a"/>
      <circle cx="600" cy="90" r="12" class="node-v" stroke-width="2"/>
      <circle cx="670" cy="65" r="12" class="node-v" stroke-width="2"/>
      <circle cx="690" cy="125" r="12" class="node-v" stroke-width="2"/>
      <circle cx="640" cy="150" r="12" class="node-v" stroke-width="2"/>
      <circle cx="620" cy="190" r="12" class="node-v" stroke-width="2"/>
      <text x="650" y="108" class="label-sm" fill="#8b5a8c" font-weight="600">2-cell</text>
    </svg>
    <div class="caption"><strong>Figure 1.1.</strong> From pairwise to higher-order. A graph captures only edges between pairs. A simplicial complex can represent a filled triangle (a 3-body interaction). A combinatorial complex allows arbitrary higher-order cells ‚Äî here, a 2-cell spanning four nodes that isn't a triangle.</div>
  </div>

  <p>
    Consider heat conduction through a chip package. A graph can model pairwise thermal contacts between adjacent layers, but <strong>a volumetric region of material</strong> ‚Äî a BEOL tile, say ‚Äî is fundamentally a higher-dimensional object. Its thermal behavior depends on the collective interaction of all boundary faces, not just pairwise contacts. Topological deep learning provides the mathematical machinery to assign features to, and pass messages between, objects of <em>any dimension</em>.
  </p>

  <div class="insight physics">
    <p><strong>Physics analogy:</strong> In electromagnetism, you already work with objects of different dimension ‚Äî charges live on points (0-cells), currents flow along paths (1-cells), flux passes through surfaces (2-cells), and charge density fills volumes (3-cells). The de Rham complex formalizes this hierarchy. Topological deep learning is, in a precise sense, the neural network version of that same idea.</p>
  </div>
</section>

<hr class="divider">

<!-- ============================================================ -->
<!-- SECTION 2 -->
<!-- ============================================================ -->
<section id="sec2">
  <h2><span class="sec-num">02</span>Graphs as Combinatorial Objects</h2>

  <p>
    Before building up, let's establish the language carefully. A <strong>graph</strong> $G = (V, E)$ consists of a set of <em>vertices</em> (or <em>nodes</em>) $V$ and a set of <em>edges</em> $E \subseteq \binom{V}{2}$, where each edge is an unordered pair of distinct vertices.
  </p>

  <div class="def-box">
    <div class="def-label">Definition ‚Äî Graph</div>
    <p>A graph $G = (V, E)$ is a pair where $V$ is a finite set (vertices) and $E \subseteq \{\{v, w\} : v, w \in V, \, v \neq w\}$ is a set of unordered pairs (edges).</p>
  </div>

  <p>
    Key point: every vertex has <strong>rank 0</strong>, and every edge has <strong>rank 1</strong>. This rank corresponds to dimension ‚Äî a vertex is a 0-dimensional object, an edge is 1-dimensional. A graph has exactly two ranks. The entire enterprise of topological deep learning is about allowing <em>more ranks</em>.
  </p>

  <h3>Adjacency and Incidence</h3>
  <p>
    Two vertices $v, w$ are <strong>adjacent</strong> (written $v \sim w$) if $\{v,w\} \in E$. A vertex $v$ is <strong>incident</strong> to an edge $e$ if $v \in e$. These two relations ‚Äî adjacency (same rank) and incidence (cross rank) ‚Äî are the only structural relationships in a graph. The adjacency matrix $\mathbf{A} \in \{0,1\}^{|V| \times |V|}$ and the incidence matrix $\mathbf{B}_1 \in \{-1,0,1\}^{|V| \times |E|}$ encode these.
  </p>

  <div class="figure">
    <svg viewBox="0 0 600 200" width="600" height="200">
      <!-- Graph -->
      <circle cx="80" cy="60" r="16" class="node-v" stroke-width="2"/>
      <circle cx="180" cy="40" r="16" class="node-v" stroke-width="2"/>
      <circle cx="180" cy="130" r="16" class="node-v" stroke-width="2"/>
      <circle cx="80" cy="150" r="16" class="node-v" stroke-width="2"/>
      <line x1="80" y1="60" x2="180" y2="40" class="edge-line"/>
      <line x1="80" y1="60" x2="180" y2="130" class="edge-line"/>
      <line x1="180" y1="40" x2="180" y2="130" class="edge-line"/>
      <line x1="80" y1="60" x2="80" y2="150" class="edge-line"/>
      <line x1="80" y1="150" x2="180" y2="130" class="edge-line"/>
      <text x="80" y="65" fill="white" font-family="Source Sans 3" font-size="11" text-anchor="middle" font-weight="600">0</text>
      <text x="180" y="45" fill="white" font-family="Source Sans 3" font-size="11" text-anchor="middle" font-weight="600">1</text>
      <text x="180" y="135" fill="white" font-family="Source Sans 3" font-size="11" text-anchor="middle" font-weight="600">2</text>
      <text x="80" y="155" fill="white" font-family="Source Sans 3" font-size="11" text-anchor="middle" font-weight="600">3</text>
      <!-- Edge labels -->
      <text x="138" y="38" class="label-sm" fill="#2a6b5a" font-weight="600">a</text>
      <text x="143" y="105" class="label-sm" fill="#2a6b5a" font-weight="600">b</text>
      <text x="192" y="90" class="label-sm" fill="#2a6b5a" font-weight="600">c</text>
      <text x="65" y="110" class="label-sm" fill="#2a6b5a" font-weight="600">d</text>
      <text x="138" y="153" class="label-sm" fill="#2a6b5a" font-weight="600">e</text>

      <!-- Adjacency Matrix -->
      <text x="340" y="25" font-family="Source Sans 3" font-size="12" font-weight="700" fill="#6b6560" text-anchor="middle">ADJACENCY A</text>
      <text x="340" y="60" font-family="JetBrains Mono" font-size="12" fill="#2a2520" text-anchor="middle">0 1 1 1</text>
      <text x="340" y="80" font-family="JetBrains Mono" font-size="12" fill="#2a2520" text-anchor="middle">1 0 1 0</text>
      <text x="340" y="100" font-family="JetBrains Mono" font-size="12" fill="#2a2520" text-anchor="middle">1 1 0 1</text>
      <text x="340" y="120" font-family="JetBrains Mono" font-size="12" fill="#2a2520" text-anchor="middle">1 0 1 0</text>
      <!-- brackets -->
      <text x="290" y="90" font-family="Crimson Pro" font-size="60" fill="#b0a89e" text-anchor="middle">[</text>
      <text x="390" y="90" font-family="Crimson Pro" font-size="60" fill="#b0a89e" text-anchor="middle">]</text>

      <!-- Incidence Matrix -->
      <text x="520" y="25" font-family="Source Sans 3" font-size="12" font-weight="700" fill="#6b6560" text-anchor="middle">INCIDENCE B‚ÇÅ</text>
      <text x="520" y="55" font-family="JetBrains Mono" font-size="11" fill="#2a2520" text-anchor="middle">a  b  c  d  e</text>
      <text x="520" y="75" font-family="JetBrains Mono" font-size="11" fill="#2a2520" text-anchor="middle"> 1  1  0  1  0</text>
      <text x="520" y="92" font-family="JetBrains Mono" font-size="11" fill="#2a2520" text-anchor="middle">-1  0  1  0  0</text>
      <text x="520" y="109" font-family="JetBrains Mono" font-size="11" fill="#2a2520" text-anchor="middle"> 0 -1 -1  0  1</text>
      <text x="520" y="126" font-family="JetBrains Mono" font-size="11" fill="#2a2520" text-anchor="middle"> 0  0  0 -1 -1</text>
      <text x="458" y="98" font-family="Crimson Pro" font-size="55" fill="#b0a89e" text-anchor="middle">[</text>
      <text x="582" y="98" font-family="Crimson Pro" font-size="55" fill="#b0a89e" text-anchor="middle">]</text>

      <text x="300" y="175" font-family="Source Sans 3" font-size="11" fill="#6b6560">Note: B‚ÇÅ·µÄB‚ÇÅ = L‚ÇÄ (the graph Laplacian, up to sign/degree corrections)</text>
    </svg>
    <div class="caption"><strong>Figure 2.1.</strong> A graph with 4 vertices and 5 edges, its adjacency matrix <strong>A</strong>, and its signed incidence matrix <strong>B‚ÇÅ</strong>. The Laplacian $L_0 = D - A$ (where $D$ is the degree matrix) governs diffusion on the graph ‚Äî this is the discrete analogue of $\nabla^2$.</div>
  </div>

  <h3>The Signed Incidence Matrix: Why the ¬±1?</h3>

  <p>
    You'll notice the incidence matrix $\mathbf{B}_1$ contains $+1$ and $-1$ entries, not just 0/1. This is not an arbitrary convention ‚Äî it's what turns the incidence matrix into a <strong>discrete gradient operator</strong>, connecting graph theory to the calculus you already know.
  </p>

  <p>
    A graph is inherently unordered ‚Äî edge $\{v_0, v_1\}$ has no preferred direction. But to do linear algebra (and especially to connect to calculus-like operators), we <strong>arbitrarily assign an orientation</strong> to each edge: pick one vertex as the "tail" (source) and the other as the "head" (target), like drawing an arrow.
  </p>

  <div class="def-box">
    <div class="def-label">Convention ‚Äî Signed Incidence</div>
    <p>For an edge $e$ oriented as $v_{\text{tail}} \to v_{\text{head}}$:</p>
    $$(\mathbf{B}_1)_{v,e} = \begin{cases} +1 & \text{if } v \text{ is the tail (source) of } e \\ -1 & \text{if } v \text{ is the head (target) of } e \\ 0 & \text{if } v \notin e \end{cases}$$
  </div>

  <p>
    <strong>Why bother with signs?</strong> Because they make $\mathbf{B}_1^\top$ act as a <strong>discrete gradient</strong>. If $f$ is a scalar function on vertices (a 0-cochain ‚Äî think temperature at nodes), then $\mathbf{B}_1^\top f$ gives the <em>difference</em> along each edge:
  </p>

  <div class="math-block">
    <div class="math-label">Discrete gradient</div>
    $$\left(\mathbf{B}_1^\top f\right)_e \;=\; f(v_{\text{head}}) - f(v_{\text{tail}}) \quad\longleftrightarrow\quad (\nabla f) \cdot \hat{e}$$
  </div>

  <p>
    This is the key payoff: the graph Laplacian emerges naturally as
  </p>

  <div class="figure">
    <svg viewBox="0 0 660 210" width="660" height="210">
      <!-- Edge with orientation -->
      <text x="330" y="20" font-family="Source Sans 3" font-size="13" font-weight="700" fill="#2a2520" text-anchor="middle">Orientation and the Discrete Gradient</text>

      <!-- Left: oriented edge -->
      <circle cx="80" cy="100" r="18" class="node-v" stroke-width="2"/>
      <circle cx="230" cy="100" r="18" class="node-v" stroke-width="2"/>
      <line x1="98" y1="100" x2="208" y2="100" stroke="#2a6b5a" stroke-width="2.5" marker-end="url(#arrow-green)"/>
      <text x="80" y="106" fill="white" font-family="Source Sans 3" font-size="12" text-anchor="middle" font-weight="600">v‚ÇÄ</text>
      <text x="230" y="106" fill="white" font-family="Source Sans 3" font-size="12" text-anchor="middle" font-weight="600">v‚ÇÅ</text>
      <text x="155" y="88" font-family="Source Sans 3" font-size="11" fill="#2a6b5a" text-anchor="middle" font-weight="600">edge a</text>
      <text x="80" y="140" font-family="Source Sans 3" font-size="11" fill="#b44a2f" text-anchor="middle" font-weight="600">+1 (tail)</text>
      <text x="230" y="140" font-family="Source Sans 3" font-size="11" fill="#3a5a8c" text-anchor="middle" font-weight="600">‚àí1 (head)</text>

      <!-- Right: the gradient interpretation -->
      <rect x="320" y="50" width="320" height="130" rx="8" fill="#f8f4ee" stroke="#d5d0c8"/>
      <text x="480" y="75" font-family="Source Sans 3" font-size="11" font-weight="700" fill="#2a2520" text-anchor="middle">If f(v‚ÇÄ) = 20¬∞C, f(v‚ÇÅ) = 35¬∞C:</text>
      <text x="480" y="105" font-family="JetBrains Mono" font-size="12" fill="#2a2520" text-anchor="middle">(B‚ÇÅ·µÄf)_a = f(head) ‚àí f(tail)</text>
      <text x="480" y="130" font-family="JetBrains Mono" font-size="12" fill="#2a6b5a" text-anchor="middle">         = 35 ‚àí 20 = +15</text>
      <text x="480" y="160" font-family="Source Sans 3" font-size="11" fill="#6b6560" text-anchor="middle">‚Üí "temperature rises along edge a"</text>
    </svg>
    <div class="caption"><strong>Figure 2.2.</strong> An arbitrary orientation on edge $a$ makes the incidence matrix a signed operator. Applying $\mathbf{B}_1^\top$ to a vertex signal computes the directional difference ‚Äî a discrete gradient. The sign tells you the direction of increase.</div>
  </div>

  <h3>The Degree Matrix, the Laplacian, and Why We Care</h3>

  <p>
    Three matrices ‚Äî the <strong>adjacency matrix</strong> $\mathbf{A}$, the <strong>degree matrix</strong> $\mathbf{D}$, and the <strong>incidence matrix</strong> $\mathbf{B}_1$ ‚Äî are connected by a beautiful identity that turns graph structure into a diffusion operator. Let's define each precisely and then verify the identity by hand on our example.
  </p>

  <div class="def-box green">
    <div class="def-label">Definition ‚Äî Degree Matrix</div>
    <p>The <strong>degree matrix</strong> $\mathbf{D} \in \mathbb{R}^{|V| \times |V|}$ is a <em>diagonal</em> matrix where each diagonal entry is the degree (number of incident edges) of that vertex:</p>
    $$D_{vv} = \deg(v) = |\{e \in E : v \in e\}|, \qquad D_{vw} = 0 \;\text{ for } v \neq w$$
    <p>It counts, for each vertex, how many connections it has. All off-diagonal entries are zero.</p>
  </div>

  <p>For the graph in Figure 2.1: vertex 0 touches edges $a, b, d$ (degree 3); vertex 1 touches $a, c$ (degree 2); vertex 2 touches $b, c, e$ (degree 3); vertex 3 touches $d, e$ (degree 2). So:</p>

  <div class="figure">
    <svg viewBox="0 0 700 490" width="700" height="490">
      <text x="350" y="22" font-family="Source Sans 3" font-size="14" font-weight="700" fill="#2a2520" text-anchor="middle">Worked Example: B‚ÇÅB‚ÇÅ·µÄ = D ‚àí A on the Figure 2.1 Graph</text>

      <!-- Step 1: The three matrices -->
      <text x="25" y="60" font-family="Source Sans 3" font-size="12" font-weight="700" fill="#b44a2f">Step 1: Write down B‚ÇÅ, D, and A</text>

      <!-- B‚ÇÅ -->
      <text x="95" y="88" font-family="Source Sans 3" font-size="11" font-weight="600" fill="#2a2520" text-anchor="middle">B‚ÇÅ (4√ó5)</text>
      <text x="45" y="108" font-family="JetBrains Mono" font-size="10" fill="#6b6560">a  b  c  d  e</text>
      <text x="30" y="126" font-family="JetBrains Mono" font-size="11" fill="#2a2520">[ 1  1  0  1  0]</text>
      <text x="30" y="143" font-family="JetBrains Mono" font-size="11" fill="#2a2520">[-1  0  1  0  0]</text>
      <text x="30" y="160" font-family="JetBrains Mono" font-size="11" fill="#2a2520">[ 0 -1 -1  0  1]</text>
      <text x="30" y="177" font-family="JetBrains Mono" font-size="11" fill="#2a2520">[ 0  0  0 -1 -1]</text>
      <text x="8" y="126" font-family="JetBrains Mono" font-size="9" fill="#6b6560">0</text>
      <text x="8" y="143" font-family="JetBrains Mono" font-size="9" fill="#6b6560">1</text>
      <text x="8" y="160" font-family="JetBrains Mono" font-size="9" fill="#6b6560">2</text>
      <text x="8" y="177" font-family="JetBrains Mono" font-size="9" fill="#6b6560">3</text>

      <!-- D -->
      <text x="310" y="88" font-family="Source Sans 3" font-size="11" font-weight="600" fill="#2a2520" text-anchor="middle">D (4√ó4)</text>
      <text x="260" y="126" font-family="JetBrains Mono" font-size="11" fill="#2a2520">[<tspan fill="#b44a2f" font-weight="600">3</tspan>  0  0  0]</text>
      <text x="260" y="143" font-family="JetBrains Mono" font-size="11" fill="#2a2520">[0  <tspan fill="#b44a2f" font-weight="600">2</tspan>  0  0]</text>
      <text x="260" y="160" font-family="JetBrains Mono" font-size="11" fill="#2a2520">[0  0  <tspan fill="#b44a2f" font-weight="600">3</tspan>  0]</text>
      <text x="260" y="177" font-family="JetBrains Mono" font-size="11" fill="#2a2520">[0  0  0  <tspan fill="#b44a2f" font-weight="600">2</tspan>]</text>
      <text x="380" y="150" font-family="Source Sans 3" font-size="10" fill="#6b6560">‚Üê degrees on</text>
      <text x="380" y="164" font-family="Source Sans 3" font-size="10" fill="#6b6560">   the diagonal</text>

      <!-- A -->
      <text x="560" y="88" font-family="Source Sans 3" font-size="11" font-weight="600" fill="#2a2520" text-anchor="middle">A (4√ó4)</text>
      <text x="505" y="126" font-family="JetBrains Mono" font-size="11" fill="#2a2520">[0  <tspan fill="#2a6b5a">1</tspan>  <tspan fill="#2a6b5a">1</tspan>  <tspan fill="#2a6b5a">1</tspan>]</text>
      <text x="505" y="143" font-family="JetBrains Mono" font-size="11" fill="#2a2520">[<tspan fill="#2a6b5a">1</tspan>  0  <tspan fill="#2a6b5a">1</tspan>  0]</text>
      <text x="505" y="160" font-family="JetBrains Mono" font-size="11" fill="#2a2520">[<tspan fill="#2a6b5a">1</tspan>  <tspan fill="#2a6b5a">1</tspan>  0  <tspan fill="#2a6b5a">1</tspan>]</text>
      <text x="505" y="177" font-family="JetBrains Mono" font-size="11" fill="#2a2520">[<tspan fill="#2a6b5a">1</tspan>  0  <tspan fill="#2a6b5a">1</tspan>  0]</text>

      <!-- Divider -->
      <line x1="25" y1="198" x2="680" y2="198" stroke="#d5d0c8" stroke-width="1"/>

      <!-- Step 2: Compute B‚ÇÅB‚ÇÅ·µÄ -->
      <text x="25" y="224" font-family="Source Sans 3" font-size="12" font-weight="700" fill="#b44a2f">Step 2: Compute B‚ÇÅB‚ÇÅ·µÄ (each entry is a dot product of two rows of B‚ÇÅ)</text>

      <!-- Highlight one calculation -->
      <rect x="25" y="238" width="650" height="110" rx="6" fill="#f8f4ee" stroke="#d5d0c8"/>

      <text x="40" y="260" font-family="Source Sans 3" font-size="11" fill="#2a2520" font-weight="600">Diagonal entries (row dotted with itself):</text>
      <text x="40" y="280" font-family="JetBrains Mono" font-size="10.5" fill="#2a2520">(B‚ÇÅB‚ÇÅ·µÄ)‚ÇÄ‚ÇÄ = (1)¬≤+(1)¬≤+(0)¬≤+(1)¬≤+(0)¬≤ = <tspan fill="#b44a2f" font-weight="600">3</tspan>  = deg(v‚ÇÄ) ‚úì</text>
      <text x="40" y="296" font-family="JetBrains Mono" font-size="10.5" fill="#2a2520">(B‚ÇÅB‚ÇÅ·µÄ)‚ÇÅ‚ÇÅ = (-1)¬≤+(0)¬≤+(1)¬≤+(0)¬≤+(0)¬≤ = <tspan fill="#b44a2f" font-weight="600">2</tspan>  = deg(v‚ÇÅ) ‚úì</text>

      <text x="40" y="318" font-family="Source Sans 3" font-size="11" fill="#2a2520" font-weight="600">Off-diagonal entries (row 0 ¬∑ row 1, row 0 ¬∑ row 2, etc.):</text>
      <text x="40" y="338" font-family="JetBrains Mono" font-size="10.5" fill="#2a2520">(B‚ÇÅB‚ÇÅ·µÄ)‚ÇÄ‚ÇÅ = (1)(-1)+(1)(0)+(0)(1)+(1)(0)+(0)(0) = <tspan fill="#3a5a8c" font-weight="600">‚àí1</tspan>  (v‚ÇÄ~v‚ÇÅ: adjacent)</text>
      <text x="40" y="355" font-family="JetBrains Mono" font-size="10.5" fill="#2a2520">(B‚ÇÅB‚ÇÅ·µÄ)‚ÇÅ‚ÇÉ = (-1)(0)+(0)(0)+(1)(0)+(0)(-1)+(0)(-1) = <tspan fill="#6b6560" font-weight="600"> 0</tspan>  (v‚ÇÅ‚âÅv‚ÇÉ: not adjacent)</text>

      <!-- Divider -->
      <line x1="25" y1="370" x2="680" y2="370" stroke="#d5d0c8" stroke-width="1"/>

      <!-- Step 3: Compare -->
      <text x="25" y="396" font-family="Source Sans 3" font-size="12" font-weight="700" fill="#b44a2f">Step 3: Verify B‚ÇÅB‚ÇÅ·µÄ = D ‚àí A</text>

      <!-- B‚ÇÅB‚ÇÅ·µÄ result -->
      <text x="95" y="418" font-family="Source Sans 3" font-size="11" font-weight="600" fill="#2a2520" text-anchor="middle">B‚ÇÅB‚ÇÅ·µÄ</text>
      <text x="40" y="438" font-family="JetBrains Mono" font-size="11" fill="#2a2520">[ <tspan fill="#b44a2f" font-weight="600">3</tspan> -1 -1 -1]</text>
      <text x="40" y="455" font-family="JetBrains Mono" font-size="11" fill="#2a2520">[-1  <tspan fill="#b44a2f" font-weight="600">2</tspan> -1  0]</text>
      <text x="40" y="472" font-family="JetBrains Mono" font-size="11" fill="#2a2520">[-1 -1  <tspan fill="#b44a2f" font-weight="600">3</tspan> -1]</text>
      <text x="40" y="489" font-family="JetBrains Mono" font-size="11" fill="#2a2520">[-1  0 -1  <tspan fill="#b44a2f" font-weight="600">2</tspan>]</text>

      <!-- Equals -->
      <text x="218" y="465" font-family="Source Sans 3" font-size="22" fill="#2a6b5a" text-anchor="middle">=</text>

      <!-- D - A -->
      <text x="340" y="418" font-family="Source Sans 3" font-size="11" font-weight="600" fill="#2a2520" text-anchor="middle">D ‚àí A</text>
      <text x="260" y="438" font-family="JetBrains Mono" font-size="11" fill="#2a2520">[<tspan fill="#b44a2f">3</tspan>-0  0-<tspan fill="#2a6b5a">1</tspan>  0-<tspan fill="#2a6b5a">1</tspan>  0-<tspan fill="#2a6b5a">1</tspan>]</text>
      <text x="260" y="455" font-family="JetBrains Mono" font-size="11" fill="#2a2520">[0-<tspan fill="#2a6b5a">1</tspan>  <tspan fill="#b44a2f">2</tspan>-0  0-<tspan fill="#2a6b5a">1</tspan>  0-0]</text>
      <text x="260" y="472" font-family="JetBrains Mono" font-size="11" fill="#2a2520">[0-<tspan fill="#2a6b5a">1</tspan>  0-<tspan fill="#2a6b5a">1</tspan>  <tspan fill="#b44a2f">3</tspan>-0  0-<tspan fill="#2a6b5a">1</tspan>]</text>
      <text x="260" y="489" font-family="JetBrains Mono" font-size="11" fill="#2a2520">[0-<tspan fill="#2a6b5a">1</tspan>  0-0  0-<tspan fill="#2a6b5a">1</tspan>  <tspan fill="#b44a2f">2</tspan>-0]</text>

      <!-- Second equals -->
      <text x="468" y="465" font-family="Source Sans 3" font-size="22" fill="#2a6b5a" text-anchor="middle">=</text>

      <!-- Result -->
      <text x="580" y="418" font-family="Source Sans 3" font-size="11" font-weight="600" fill="#2a6b5a" text-anchor="middle">L‚ÇÄ ‚úì</text>
      <text x="500" y="438" font-family="JetBrains Mono" font-size="11" fill="#2a6b5a" font-weight="600">[ 3 -1 -1 -1]</text>
      <text x="500" y="455" font-family="JetBrains Mono" font-size="11" fill="#2a6b5a" font-weight="600">[-1  2 -1  0]</text>
      <text x="500" y="472" font-family="JetBrains Mono" font-size="11" fill="#2a6b5a" font-weight="600">[-1 -1  3 -1]</text>
      <text x="500" y="489" font-family="JetBrains Mono" font-size="11" fill="#2a6b5a" font-weight="600">[-1  0 -1  2]</text>
    </svg>
    <div class="caption"><strong>Figure 2.3.</strong> Full worked verification of $\mathbf{B}_1\mathbf{B}_1^\top = \mathbf{D} - \mathbf{A} = \mathbf{L}_0$ for the Figure 2.1 graph. The diagonal of $\mathbf{B}_1\mathbf{B}_1^\top$ always gives the degree (each row's squared entries sum to the number of incident edges). The off-diagonal entry at $(v,w)$ is $-1$ if $v$ and $w$ share an edge (they appear with opposite signs in exactly one column of $\mathbf{B}_1$), and $0$ otherwise.</div>
  </div>

  <p>This isn't a coincidence ‚Äî it works for <em>any</em> graph, and the proof is short:</p>

  <div class="def-box blue">
    <div class="def-label">Why it always works</div>
    <p>Entry $(v,w)$ of $\mathbf{B}_1\mathbf{B}_1^\top$ is the dot product of rows $v$ and $w$ of $\mathbf{B}_1$.</p>
    <p style="margin-left:1.5rem;">
      <strong>If $v = w$:</strong> You're dotting row $v$ with itself. Each edge incident to $v$ contributes $(\pm 1)^2 = 1$, everything else contributes $0$. Sum = $\deg(v) = D_{vv}$. ‚úì<br><br>
      <strong>If $v \sim w$ (adjacent):</strong> They share exactly one edge $e$. In column $e$, one has $+1$ and the other $-1$ (tail vs head). Product = $-1$. In all other columns, at most one of them is nonzero, so product = $0$. Sum = $-1 = 0 - A_{vw} = (D-A)_{vw}$. ‚úì<br><br>
      <strong>If $v \not\sim w$ (not adjacent):</strong> No edge contains both. In every column, at least one of them is $0$. Sum = $0 = 0 - 0 = (D-A)_{vw}$. ‚úì
    </p>
  </div>

  <h3>Why the Laplacian Matters: Discrete Diffusion</h3>

  <p>
    So $\mathbf{L}_0 = \mathbf{D} - \mathbf{A}$ has degrees on the diagonal and $-1$ wherever two vertices share an edge. Why is this the right operator for physics?
  </p>

  <p>
    Apply $\mathbf{L}_0$ to a temperature vector $\mathbf{T}$. The result at vertex $v$ is:
  </p>

  <div class="math-block">
    <div class="math-label">Laplacian applied to a signal</div>
    $$(\mathbf{L}_0 \mathbf{T})_v = \deg(v) \cdot T_v - \sum_{w \sim v} T_w = \sum_{w \sim v}\left(T_v - T_w\right)$$
  </div>

  <p>
    Read that last expression: <strong>the Laplacian at $v$ sums up all the temperature <em>differences</em> between $v$ and its neighbors</strong>. This is exactly the discrete version of $\nabla^2 T$ ‚Äî the divergence of the gradient ‚Äî which governs heat diffusion. The equivalence $\deg(v) \cdot T_v - \sum T_w = \sum(T_v - T_w)$ is why $\mathbf{D} - \mathbf{A}$ is the right combination: the degree term and the adjacency term conspire to produce pairwise differences.
  </p>

  <div class="figure">
    <svg viewBox="0 0 660 230" width="660" height="230">
      <text x="330" y="22" font-family="Source Sans 3" font-size="13" font-weight="700" fill="#2a2520" text-anchor="middle">The Laplacian Measures "How Different Am I From My Neighbors?"</text>

      <!-- Graph with temperatures -->
      <circle cx="100" cy="110" r="28" class="node-v" stroke-width="2"/>
      <circle cx="230" cy="70" r="28" class="node-v" stroke-width="2"/>
      <circle cx="230" cy="155" r="28" class="node-v" stroke-width="2"/>
      <circle cx="140" cy="190" r="28" class="node-v" stroke-width="2"/>
      <line x1="125" y1="100" x2="205" y2="78" class="edge-line"/>
      <line x1="125" y1="120" x2="205" y2="145" class="edge-line"/>
      <line x1="230" y1="98" x2="230" y2="127" class="edge-line"/>
      <line x1="110" y1="136" x2="130" y2="165" class="edge-line"/>
      <line x1="160" y1="180" x2="210" y2="163" class="edge-line"/>

      <!-- Temperature labels -->
      <text x="100" y="115" fill="white" font-family="JetBrains Mono" font-size="13" text-anchor="middle" font-weight="600">50¬∞</text>
      <text x="230" y="75" fill="white" font-family="JetBrains Mono" font-size="13" text-anchor="middle" font-weight="600">20¬∞</text>
      <text x="230" y="160" fill="white" font-family="JetBrains Mono" font-size="13" text-anchor="middle" font-weight="600">30¬∞</text>
      <text x="140" y="195" fill="white" font-family="JetBrains Mono" font-size="13" text-anchor="middle" font-weight="600">10¬∞</text>

      <!-- Computation for vertex 0 -->
      <rect x="330" y="45" width="310" height="170" rx="8" fill="#f8f4ee" stroke="#d5d0c8"/>
      <text x="345" y="70" font-family="Source Sans 3" font-size="11" font-weight="700" fill="#b44a2f">(L‚ÇÄT)‚ÇÄ at vertex 0 (T‚ÇÄ = 50¬∞):</text>

      <text x="345" y="98" font-family="JetBrains Mono" font-size="11" fill="#2a2520">= (50‚àí20) + (50‚àí30) + (50‚àí10)</text>
      <text x="345" y="118" font-family="JetBrains Mono" font-size="11" fill="#6b6560">    ‚Üë v‚ÇÅ       ‚Üë v‚ÇÇ       ‚Üë v‚ÇÉ</text>
      <text x="345" y="142" font-family="JetBrains Mono" font-size="11" fill="#2a6b5a" font-weight="600">= 30 + 20 + 40 = 90</text>

      <text x="345" y="172" font-family="Source Sans 3" font-size="11" fill="#2a2520">Large positive ‚Üí v‚ÇÄ is much <tspan font-weight="600" fill="#b44a2f">hotter</tspan></text>
      <text x="345" y="190" font-family="Source Sans 3" font-size="11" fill="#2a2520">than its neighbors ‚Üí heat flows <tspan font-weight="600">out</tspan></text>
      <text x="345" y="208" font-family="Source Sans 3" font-size="11" fill="#6b6560">(L‚ÇÄT = 0 means thermal equilibrium)</text>
    </svg>
    <div class="caption"><strong>Figure 2.4.</strong> The Laplacian applied to a temperature field. At vertex 0 (50¬∞), surrounded by cooler neighbors (20¬∞, 30¬∞, 10¬∞), the Laplacian gives a large positive value ‚Äî indicating net heat outflow. A vertex in equilibrium with its neighbors gives $(L_0 T)_v = 0$. The steady-state heat equation $L_0 T = 0$ says: every vertex is at the average temperature of its neighbors.</div>
  </div>

  <p>This gives three reasons why the Laplacian is the central object:</p>

  <div class="insight key">
    <p><strong>1. Diffusion:</strong> The heat equation $\dot{T} = -\alpha \mathbf{L}_0 T$ says temperature evolves by flowing from hot to cold ‚Äî directly from the "sum of differences" structure.</p>
    <p><strong>2. Conservation:</strong> $\mathbf{L}_0$ is positive semi-definite (since $\mathbf{L}_0 = \mathbf{B}_1\mathbf{B}_1^\top$ is a Gram matrix) and its row sums are zero ($\mathbf{L}_0 \mathbf{1} = 0$). This means total "heat" is conserved under diffusion ‚Äî a physical requirement.</p>
    <p><strong>3. Spectral structure:</strong> The eigenvalues $0 = \lambda_0 \leq \lambda_1 \leq \cdots$ measure connectivity. $\lambda_1 = 0$ iff the graph is disconnected. The eigenvectors form a Fourier-like basis for graph signals ‚Äî the foundation of spectral GNNs (ChebNet, GCN).</p>
  </div>

  <p>
    Without the signs in $\mathbf{B}_1$, you'd get $\mathbf{D} + \mathbf{A}$ instead ‚Äî which sums neighbor values rather than computing differences. That operator doesn't conserve anything, isn't positive semi-definite, and has no connection to diffusion. The signs are what make the Laplacian a <em>second-order difference operator</em> (discrete $\nabla^2$).
  </p>

  <div class="insight">
    <p><strong>The choice of orientation is arbitrary.</strong> Flipping an edge's direction just negates that column of $\mathbf{B}_1$. All derived quantities ‚Äî the Laplacian $\mathbf{L}_0 = \mathbf{B}_1\mathbf{B}_1^\top$, Hodge Laplacians, message-passing operators ‚Äî involve products like $\mathbf{B}^\top\mathbf{B}$ where the signs cancel, so they are <strong>invariant</strong> to the orientation choice. The orientation is a bookkeeping device, not a physical assumption.</p>
  </div>

  <h3>Spectral Structure: Eigenvalues and Eigenvectors of $\mathbf{L}_0$</h3>

  <p>
    The three properties above ‚Äî diffusion, conservation, spectral structure ‚Äî all flow from the <em>eigendecomposition</em> of $\mathbf{L}_0$. Let's work through this completely for our example, starting from the definition of diagonalization.
  </p>

  <h4>Review: Matrix Diagonalization</h4>

  <p>
    A real symmetric matrix $\mathbf{M} \in \mathbb{R}^{n \times n}$ can always be decomposed as:
  </p>

  <div class="math-block">
    <div class="math-label">Eigendecomposition (Spectral Theorem)</div>
    $$\mathbf{M} = \mathbf{P} \boldsymbol{\Lambda} \mathbf{P}^\top \qquad\text{where}\qquad \boldsymbol{\Lambda} = \text{diag}(\lambda_0, \lambda_1, \ldots, \lambda_{n-1})$$
  </div>

  <p>
    Here $\boldsymbol{\Lambda}$ is diagonal (eigenvalues on the diagonal), and $\mathbf{P}$ is an orthogonal matrix whose columns are the corresponding eigenvectors: $\mathbf{P} = [\mathbf{v}_0 \mid \mathbf{v}_1 \mid \cdots \mid \mathbf{v}_{n-1}]$. Orthogonal means $\mathbf{P}^\top\mathbf{P} = \mathbf{I}$ ‚Äî the eigenvectors form an orthonormal basis.
  </p>

  <p>
    The defining property of each eigenpair is:
  </p>

  <div class="math-block">
    <div class="math-label">Eigenvector equation</div>
    $$\mathbf{M}\mathbf{v}_i = \lambda_i \mathbf{v}_i$$
  </div>

  <p>
    Applying $\mathbf{M}$ to eigenvector $\mathbf{v}_i$ just <em>scales</em> it by $\lambda_i$ ‚Äî it doesn't change direction. The eigenvalue $\lambda_i$ is the scaling factor.
  </p>

  <div class="def-box">
    <div class="def-label">Recipe ‚Äî Finding Eigenvalues and Eigenvectors</div>
    <p><strong>Step 1.</strong> Find eigenvalues by solving the <em>characteristic equation</em>: $\det(\mathbf{M} - \lambda\mathbf{I}) = 0$. This is a degree-$n$ polynomial in $\lambda$; its roots are the eigenvalues.</p>
    <p><strong>Step 2.</strong> For each eigenvalue $\lambda_i$, find eigenvectors by solving the homogeneous system $(\mathbf{M} - \lambda_i\mathbf{I})\mathbf{v} = \mathbf{0}$. The solution space (the <em>null space</em> or <em>kernel</em>) gives the eigenvectors.</p>
    <p><strong>Step 3.</strong> Normalize: $\hat{\mathbf{v}}_i = \mathbf{v}_i / \|\mathbf{v}_i\|$. For a symmetric matrix, eigenvectors from distinct eigenvalues are automatically orthogonal. Within a repeated eigenvalue, use Gram-Schmidt.</p>
  </div>

  <h4>Step 1: The Characteristic Polynomial of Our $\mathbf{L}_0$</h4>

  <p>We need $\det(\mathbf{L}_0 - \lambda\mathbf{I}) = 0$ for:</p>

  <div class="math-block">
    <div class="math-label">Characteristic matrix</div>
    $$\mathbf{L}_0 - \lambda\mathbf{I} = \begin{pmatrix} 3-\lambda & -1 & -1 & -1 \\ -1 & 2-\lambda & -1 & 0 \\ -1 & -1 & 3-\lambda & -1 \\ -1 & 0 & -1 & 2-\lambda \end{pmatrix}$$
  </div>

  <p>
    Before grinding through a $4 \times 4$ determinant, we can use two shortcuts:
  </p>

  <div class="insight">
    <p><strong>Shortcut 1 ‚Äî $\lambda = 0$ is always an eigenvalue.</strong> Since $\mathbf{L}_0 \mathbf{1} = \mathbf{0}$ (row sums are zero), the all-ones vector $\mathbf{1} = (1,1,1,1)^\top$ is an eigenvector with eigenvalue $0$. For a connected graph, $\lambda_0 = 0$ has multiplicity exactly 1.</p>
    <p><strong>Shortcut 2 ‚Äî The trace gives the sum.</strong> $\text{tr}(\mathbf{L}_0) = 3 + 2 + 3 + 2 = 10 = \sum_i \lambda_i$.</p>
  </div>

  <p>
    For our graph, the characteristic polynomial factors as:
  </p>

  <div class="math-block">
    <div class="math-label">Characteristic polynomial</div>
    $$\det(\mathbf{L}_0 - \lambda\mathbf{I}) = \lambda(\lambda - 2)(\lambda - 4)^2 = 0$$
  </div>

  <p>giving eigenvalues $\lambda_0 = 0$, $\lambda_1 = 2$, $\lambda_2 = \lambda_3 = 4$ (the last has <em>algebraic multiplicity</em> 2). Check: $0 + 2 + 4 + 4 = 10$ ‚úì.</p>

  <h4>Step 2: Finding the Eigenvectors</h4>

  <p>For each eigenvalue, we solve $(\mathbf{L}_0 - \lambda_i \mathbf{I})\mathbf{v} = \mathbf{0}$:</p>

  <div class="figure">
    <svg viewBox="0 0 700 520" width="700" height="520">
      <text x="350" y="22" font-family="Source Sans 3" font-size="14" font-weight="700" fill="#2a2520" text-anchor="middle">Finding the Four Eigenvectors of L‚ÇÄ</text>

      <!-- Œª = 0 -->
      <rect x="15" y="42" width="325" height="200" rx="8" fill="white" stroke="#b44a2f" stroke-width="1.5"/>
      <rect x="15" y="42" width="325" height="28" rx="8" fill="#e8a88a" fill-opacity="0.3"/>
      <text x="177" y="61" font-family="Source Sans 3" font-size="12" font-weight="700" fill="#b44a2f" text-anchor="middle">Œª‚ÇÄ = 0 ‚Äî The Constant Mode</text>

      <text x="30" y="88" font-family="Source Sans 3" font-size="10.5" fill="#2a2520">Solve (L‚ÇÄ ‚àí 0¬∑I)v = L‚ÇÄv = 0:</text>
      <text x="30" y="108" font-family="JetBrains Mono" font-size="10" fill="#2a2520">[ 3 -1 -1 -1] [v‚ÇÄ]   [0]</text>
      <text x="30" y="123" font-family="JetBrains Mono" font-size="10" fill="#2a2520">[-1  2 -1  0] [v‚ÇÅ] = [0]</text>
      <text x="30" y="138" font-family="JetBrains Mono" font-size="10" fill="#2a2520">[-1 -1  3 -1] [v‚ÇÇ]   [0]</text>
      <text x="30" y="153" font-family="JetBrains Mono" font-size="10" fill="#2a2520">[-1  0 -1  2] [v‚ÇÉ]   [0]</text>
      <text x="30" y="178" font-family="Source Sans 3" font-size="10.5" fill="#2a2520">Row sums = 0, so v‚ÇÄ = v‚ÇÅ = v‚ÇÇ = v‚ÇÉ works.</text>
      <text x="30" y="198" font-family="JetBrains Mono" font-size="12" fill="#b44a2f" font-weight="600">v‚ÇÄ = (1, 1, 1, 1)·µÄ</text>
      <text x="30" y="218" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" font-style="italic">Constant everywhere ‚Äî no spatial variation</text>
      <text x="30" y="232" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" font-style="italic">Physically: uniform temperature (equilibrium)</text>

      <!-- Œª = 2 -->
      <rect x="360" y="42" width="325" height="200" rx="8" fill="white" stroke="#2a6b5a" stroke-width="1.5"/>
      <rect x="360" y="42" width="325" height="28" rx="8" fill="#8ec5b6" fill-opacity="0.3"/>
      <text x="522" y="61" font-family="Source Sans 3" font-size="12" font-weight="700" fill="#2a6b5a" text-anchor="middle">Œª‚ÇÅ = 2 ‚Äî The Fiedler Vector</text>

      <text x="375" y="88" font-family="Source Sans 3" font-size="10.5" fill="#2a2520">Solve (L‚ÇÄ ‚àí 2I)v = 0:</text>
      <text x="375" y="108" font-family="JetBrains Mono" font-size="10" fill="#2a2520">[ 1 -1 -1 -1] [v‚ÇÄ]   [0]</text>
      <text x="375" y="123" font-family="JetBrains Mono" font-size="10" fill="#2a2520">[-1  0 -1  0] [v‚ÇÅ] = [0]</text>
      <text x="375" y="138" font-family="JetBrains Mono" font-size="10" fill="#2a2520">[-1 -1  1 -1] [v‚ÇÇ]   [0]</text>
      <text x="375" y="153" font-family="JetBrains Mono" font-size="10" fill="#2a2520">[-1  0 -1  0] [v‚ÇÉ]   [0]</text>
      <text x="375" y="178" font-family="Source Sans 3" font-size="10.5" fill="#2a2520">Row 2 gives v‚ÇÄ = ‚àív‚ÇÇ; Row 4 gives v‚ÇÄ = ‚àív‚ÇÇ.</text>
      <text x="375" y="193" font-family="Source Sans 3" font-size="10.5" fill="#2a2520">Substituting: v‚ÇÄ = v‚ÇÇ = 0, v‚ÇÅ = ‚àív‚ÇÉ.</text>
      <text x="375" y="213" font-family="JetBrains Mono" font-size="12" fill="#2a6b5a" font-weight="600">v‚ÇÅ = (0, 1, 0, ‚àí1)·µÄ</text>
      <text x="375" y="232" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" font-style="italic">Lowest-frequency oscillation</text>

      <!-- Œª = 4 (first) -->
      <rect x="15" y="260" width="325" height="240" rx="8" fill="white" stroke="#3a5a8c" stroke-width="1.5"/>
      <rect x="15" y="260" width="325" height="28" rx="8" fill="#a8c0e0" fill-opacity="0.3"/>
      <text x="177" y="279" font-family="Source Sans 3" font-size="12" font-weight="700" fill="#3a5a8c" text-anchor="middle">Œª‚ÇÇ = 4 ‚Äî High-Frequency Mode (1 of 2)</text>

      <text x="30" y="305" font-family="Source Sans 3" font-size="10.5" fill="#2a2520">Solve (L‚ÇÄ ‚àí 4I)v = 0:</text>
      <text x="30" y="325" font-family="JetBrains Mono" font-size="10" fill="#2a2520">[-1 -1 -1 -1] [v‚ÇÄ]   [0]</text>
      <text x="30" y="340" font-family="JetBrains Mono" font-size="10" fill="#2a2520">[-1 -2 -1  0] [v‚ÇÅ] = [0]</text>
      <text x="30" y="355" font-family="JetBrains Mono" font-size="10" fill="#2a2520">[-1 -1 -1 -1] [v‚ÇÇ]   [0]</text>
      <text x="30" y="370" font-family="JetBrains Mono" font-size="10" fill="#2a2520">[-1  0 -1 -2] [v‚ÇÉ]   [0]</text>

      <text x="30" y="395" font-family="Source Sans 3" font-size="10.5" fill="#2a2520">Row 1: v‚ÇÄ+v‚ÇÅ+v‚ÇÇ+v‚ÇÉ = 0 (sum to zero).</text>
      <text x="30" y="412" font-family="Source Sans 3" font-size="10.5" fill="#2a2520">Row 2: v‚ÇÄ+2v‚ÇÅ+v‚ÇÇ = 0.</text>
      <text x="30" y="429" font-family="Source Sans 3" font-size="10.5" fill="#2a2520">Null space is 2-dimensional. One basis vector:</text>
      <text x="30" y="449" font-family="JetBrains Mono" font-size="12" fill="#3a5a8c" font-weight="600">v‚ÇÇ = (1, ‚àí1, 1, ‚àí1)·µÄ</text>
      <text x="30" y="470" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" font-style="italic">Checkerboard: alternates + and ‚àí</text>
      <text x="30" y="488" font-family="Source Sans 3" font-size="10.5" fill="#6b6560">Verify: L‚ÇÄ(1,‚àí1,1,‚àí1)·µÄ = (4,‚àí4,4,‚àí4)·µÄ ‚úì</text>

      <!-- Œª = 4 (second) -->
      <rect x="360" y="260" width="325" height="240" rx="8" fill="white" stroke="#8b5a8c" stroke-width="1.5"/>
      <rect x="360" y="260" width="325" height="28" rx="8" fill="#c8a8d0" fill-opacity="0.3"/>
      <text x="522" y="279" font-family="Source Sans 3" font-size="12" font-weight="700" fill="#8b5a8c" text-anchor="middle">Œª‚ÇÉ = 4 ‚Äî High-Frequency Mode (2 of 2)</text>

      <text x="375" y="305" font-family="Source Sans 3" font-size="10.5" fill="#2a2520">Same system (L‚ÇÄ ‚àí 4I)v = 0.</text>
      <text x="375" y="325" font-family="Source Sans 3" font-size="10.5" fill="#2a2520">Second independent solution (orthogonal to v‚ÇÇ):</text>
      <text x="375" y="355" font-family="JetBrains Mono" font-size="12" fill="#8b5a8c" font-weight="600">v‚ÇÉ = (1, 0, ‚àí1, 0)·µÄ</text>

      <text x="375" y="380" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" font-style="italic">Vertices 0 and 2 have opposite sign;</text>
      <text x="375" y="398" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" font-style="italic">vertices 1 and 3 are zero.</text>
      <text x="375" y="418" font-family="Source Sans 3" font-size="10.5" fill="#6b6560">Verify: L‚ÇÄ(1,0,‚àí1,0)·µÄ = (4,0,‚àí4,0)·µÄ ‚úì</text>

      <text x="375" y="448" font-family="Source Sans 3" font-size="10.5" fill="#2a2520" font-weight="600">Orthogonality check:</text>
      <text x="375" y="468" font-family="JetBrains Mono" font-size="10" fill="#2a2520">v‚ÇÇ ¬∑ v‚ÇÉ = (1)(1)+(‚àí1)(0)+(1)(‚àí1)+(‚àí1)(0) = 0 ‚úì</text>

      <text x="375" y="490" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" font-style="italic">Repeated eigenvalue ‚Üí must manually</text>
      <text x="375" y="505" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" font-style="italic">choose orthogonal basis (here natural)</text>
    </svg>
    <div class="caption"><strong>Figure 2.5.</strong> The four eigenvectors of $\mathbf{L}_0$, computed by solving $(\mathbf{L}_0 - \lambda_i\mathbf{I})\mathbf{v} = \mathbf{0}$ for each eigenvalue. The constant mode ($\lambda_0 = 0$) represents equilibrium. The Fiedler vector ($\lambda_1 = 2$) gives the smoothest non-trivial partition. The two high-frequency modes ($\lambda_2 = \lambda_3 = 4$) oscillate rapidly across the graph.</div>
  </div>

  <h4>Step 3: The Diagonalization</h4>

  <p>Assembling the (normalized) eigenvectors as columns of $\mathbf{P}$ and eigenvalues into $\boldsymbol{\Lambda}$:</p>

  <div class="math-block">
    <div class="math-label">Diagonalization: $\mathbf{L}_0 = \mathbf{P}\boldsymbol{\Lambda}\mathbf{P}^\top$</div>
    $$\underbrace{\begin{pmatrix} 3 & -1 & -1 & -1 \\ -1 & 2 & -1 & 0 \\ -1 & -1 & 3 & -1 \\ -1 & 0 & -1 & 2 \end{pmatrix}}_{\mathbf{L}_0} = \underbrace{\begin{pmatrix} \tfrac{1}{2} & 0 & \tfrac{1}{2} & \tfrac{1}{\sqrt{2}} \\ \tfrac{1}{2} & \tfrac{1}{\sqrt{2}} & -\tfrac{1}{2} & 0 \\ \tfrac{1}{2} & 0 & \tfrac{1}{2} & -\tfrac{1}{\sqrt{2}} \\ \tfrac{1}{2} & -\tfrac{1}{\sqrt{2}} & -\tfrac{1}{2} & 0 \end{pmatrix}}_{\mathbf{P}} \underbrace{\begin{pmatrix} 0 & & & \\ & 2 & & \\ & & 4 & \\ & & & 4 \end{pmatrix}}_{\boldsymbol{\Lambda}} \underbrace{\mathbf{P}^\top}_{\mathbf{P}^{-1}}$$
  </div>

  <p>
    Because $\mathbf{P}$ is orthogonal ($\mathbf{P}^\top = \mathbf{P}^{-1}$), this gives us two equivalent readings:
  </p>

  <p style="margin-left:1.5rem;">
    <strong>Forward:</strong> $\mathbf{L}_0 = \sum_{i=0}^{3} \lambda_i \, \hat{\mathbf{v}}_i \hat{\mathbf{v}}_i^\top$ ‚Äî the Laplacian is a weighted sum of projection matrices, one per eigenvector.<br>
    <strong>Inverse:</strong> $\mathbf{P}^\top \mathbf{L}_0 \mathbf{P} = \boldsymbol{\Lambda}$ ‚Äî in the eigenvector basis, $\mathbf{L}_0$ acts by pure scaling (no mixing).
  </p>

  <h4>Physical Interpretation: Vibration Modes of the Graph</h4>

  <p>
    The eigenvectors are the <strong>fundamental modes of oscillation</strong> on the graph ‚Äî the exact analogue of Fourier modes on a continuous domain. Low eigenvalues correspond to slow, smooth variation; high eigenvalues correspond to rapid oscillation.
  </p>

  <div class="figure">
    <svg viewBox="0 0 700 370" width="700" height="370">
      <text x="350" y="22" font-family="Source Sans 3" font-size="14" font-weight="700" fill="#2a2520" text-anchor="middle">The Four "Fourier Modes" of Our Graph</text>
      <text x="350" y="42" font-family="Source Sans 3" font-size="11" fill="#6b6560" text-anchor="middle">Eigenvector values shown at each vertex ¬∑ Color: red = positive, blue = negative, gray = zero</text>

      <!-- Mode 0: Œª=0 -->
      <rect x="15" y="60" width="155" height="280" rx="8" fill="white" stroke="#d5d0c8"/>
      <text x="92" y="82" font-family="Source Sans 3" font-size="11" font-weight="700" fill="#b44a2f" text-anchor="middle">Œª‚ÇÄ = 0 (DC)</text>
      <!-- Graph -->
      <line x1="55" y1="150" x2="130" y2="120" stroke="#d5d0c8" stroke-width="1.5"/>
      <line x1="55" y1="150" x2="130" y2="190" stroke="#d5d0c8" stroke-width="1.5"/>
      <line x1="130" y1="120" x2="130" y2="190" stroke="#d5d0c8" stroke-width="1.5"/>
      <line x1="55" y1="150" x2="75" y2="220" stroke="#d5d0c8" stroke-width="1.5"/>
      <line x1="75" y1="220" x2="130" y2="190" stroke="#d5d0c8" stroke-width="1.5"/>
      <circle cx="55" cy="150" r="18" fill="#e07050" stroke="#b44a2f" stroke-width="2"/>
      <circle cx="130" cy="120" r="18" fill="#e07050" stroke="#b44a2f" stroke-width="2"/>
      <circle cx="130" cy="190" r="18" fill="#e07050" stroke="#b44a2f" stroke-width="2"/>
      <circle cx="75" cy="220" r="18" fill="#e07050" stroke="#b44a2f" stroke-width="2"/>
      <text x="55" y="155" fill="white" font-family="JetBrains Mono" font-size="11" text-anchor="middle" font-weight="500">+1</text>
      <text x="130" y="125" fill="white" font-family="JetBrains Mono" font-size="11" text-anchor="middle" font-weight="500">+1</text>
      <text x="130" y="195" fill="white" font-family="JetBrains Mono" font-size="11" text-anchor="middle" font-weight="500">+1</text>
      <text x="75" y="225" fill="white" font-family="JetBrains Mono" font-size="11" text-anchor="middle" font-weight="500">+1</text>
      <text x="92" y="260" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle" font-style="italic">"All same sign"</text>
      <text x="92" y="278" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">Uniform: no variation</text>
      <text x="92" y="296" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">= thermal equilibrium</text>
      <text x="92" y="320" font-family="Source Sans 3" font-size="10" fill="#b44a2f" text-anchor="middle" font-weight="600">frequency: 0</text>

      <!-- Mode 1: Œª=2 -->
      <rect x="185" y="60" width="155" height="280" rx="8" fill="white" stroke="#d5d0c8"/>
      <text x="262" y="82" font-family="Source Sans 3" font-size="11" font-weight="700" fill="#2a6b5a" text-anchor="middle">Œª‚ÇÅ = 2 (Fiedler)</text>
      <line x1="225" y1="150" x2="300" y2="120" stroke="#d5d0c8" stroke-width="1.5"/>
      <line x1="225" y1="150" x2="300" y2="190" stroke="#d5d0c8" stroke-width="1.5"/>
      <line x1="300" y1="120" x2="300" y2="190" stroke="#d5d0c8" stroke-width="1.5"/>
      <line x1="225" y1="150" x2="245" y2="220" stroke="#d5d0c8" stroke-width="1.5"/>
      <line x1="245" y1="220" x2="300" y2="190" stroke="#d5d0c8" stroke-width="1.5"/>
      <circle cx="225" cy="150" r="18" fill="#c0c0c0" stroke="#888" stroke-width="2"/>
      <circle cx="300" cy="120" r="18" fill="#e07050" stroke="#b44a2f" stroke-width="2"/>
      <circle cx="300" cy="190" r="18" fill="#c0c0c0" stroke="#888" stroke-width="2"/>
      <circle cx="245" cy="220" r="18" fill="#5080c0" stroke="#3a5a8c" stroke-width="2"/>
      <text x="225" y="155" fill="white" font-family="JetBrains Mono" font-size="11" text-anchor="middle" font-weight="500">0</text>
      <text x="300" y="125" fill="white" font-family="JetBrains Mono" font-size="11" text-anchor="middle" font-weight="500">+1</text>
      <text x="300" y="195" fill="white" font-family="JetBrains Mono" font-size="11" text-anchor="middle" font-weight="500">0</text>
      <text x="245" y="225" fill="white" font-family="JetBrains Mono" font-size="11" text-anchor="middle" font-weight="500">‚àí1</text>
      <text x="262" y="260" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle" font-style="italic">"One sign change"</text>
      <text x="262" y="278" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">Smoothest partition</text>
      <text x="262" y="296" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">= best 2-way graph cut</text>
      <text x="262" y="320" font-family="Source Sans 3" font-size="10" fill="#2a6b5a" text-anchor="middle" font-weight="600">frequency: low</text>

      <!-- Mode 2: Œª=4 (checkerboard) -->
      <rect x="355" y="60" width="155" height="280" rx="8" fill="white" stroke="#d5d0c8"/>
      <text x="432" y="82" font-family="Source Sans 3" font-size="11" font-weight="700" fill="#3a5a8c" text-anchor="middle">Œª‚ÇÇ = 4 (high)</text>
      <line x1="395" y1="150" x2="470" y2="120" stroke="#d5d0c8" stroke-width="1.5"/>
      <line x1="395" y1="150" x2="470" y2="190" stroke="#d5d0c8" stroke-width="1.5"/>
      <line x1="470" y1="120" x2="470" y2="190" stroke="#d5d0c8" stroke-width="1.5"/>
      <line x1="395" y1="150" x2="415" y2="220" stroke="#d5d0c8" stroke-width="1.5"/>
      <line x1="415" y1="220" x2="470" y2="190" stroke="#d5d0c8" stroke-width="1.5"/>
      <circle cx="395" cy="150" r="18" fill="#e07050" stroke="#b44a2f" stroke-width="2"/>
      <circle cx="470" cy="120" r="18" fill="#5080c0" stroke="#3a5a8c" stroke-width="2"/>
      <circle cx="470" cy="190" r="18" fill="#e07050" stroke="#b44a2f" stroke-width="2"/>
      <circle cx="415" cy="220" r="18" fill="#5080c0" stroke="#3a5a8c" stroke-width="2"/>
      <text x="395" y="155" fill="white" font-family="JetBrains Mono" font-size="11" text-anchor="middle" font-weight="500">+1</text>
      <text x="470" y="125" fill="white" font-family="JetBrains Mono" font-size="11" text-anchor="middle" font-weight="500">‚àí1</text>
      <text x="470" y="195" fill="white" font-family="JetBrains Mono" font-size="11" text-anchor="middle" font-weight="500">+1</text>
      <text x="415" y="225" fill="white" font-family="JetBrains Mono" font-size="11" text-anchor="middle" font-weight="500">‚àí1</text>
      <text x="432" y="260" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle" font-style="italic">"Alternating signs"</text>
      <text x="432" y="278" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">Every neighbor differs</text>
      <text x="432" y="296" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">= maximum oscillation</text>
      <text x="432" y="320" font-family="Source Sans 3" font-size="10" fill="#3a5a8c" text-anchor="middle" font-weight="600">frequency: high</text>

      <!-- Mode 3: Œª=4 (second) -->
      <rect x="525" y="60" width="155" height="280" rx="8" fill="white" stroke="#d5d0c8"/>
      <text x="602" y="82" font-family="Source Sans 3" font-size="11" font-weight="700" fill="#8b5a8c" text-anchor="middle">Œª‚ÇÉ = 4 (high)</text>
      <line x1="565" y1="150" x2="640" y2="120" stroke="#d5d0c8" stroke-width="1.5"/>
      <line x1="565" y1="150" x2="640" y2="190" stroke="#d5d0c8" stroke-width="1.5"/>
      <line x1="640" y1="120" x2="640" y2="190" stroke="#d5d0c8" stroke-width="1.5"/>
      <line x1="565" y1="150" x2="585" y2="220" stroke="#d5d0c8" stroke-width="1.5"/>
      <line x1="585" y1="220" x2="640" y2="190" stroke="#d5d0c8" stroke-width="1.5"/>
      <circle cx="565" cy="150" r="18" fill="#e07050" stroke="#b44a2f" stroke-width="2"/>
      <circle cx="640" cy="120" r="18" fill="#c0c0c0" stroke="#888" stroke-width="2"/>
      <circle cx="640" cy="190" r="18" fill="#5080c0" stroke="#3a5a8c" stroke-width="2"/>
      <circle cx="585" cy="220" r="18" fill="#c0c0c0" stroke="#888" stroke-width="2"/>
      <text x="565" y="155" fill="white" font-family="JetBrains Mono" font-size="11" text-anchor="middle" font-weight="500">+1</text>
      <text x="640" y="125" fill="white" font-family="JetBrains Mono" font-size="11" text-anchor="middle" font-weight="500">0</text>
      <text x="640" y="195" fill="white" font-family="JetBrains Mono" font-size="11" text-anchor="middle" font-weight="500">‚àí1</text>
      <text x="585" y="225" fill="white" font-family="JetBrains Mono" font-size="11" text-anchor="middle" font-weight="500">0</text>
      <text x="602" y="260" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle" font-style="italic">"Opposite pair"</text>
      <text x="602" y="278" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">v‚ÇÄ and v‚ÇÇ anti-correlated</text>
      <text x="602" y="296" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">= localized high-freq mode</text>
      <text x="602" y="320" font-family="Source Sans 3" font-size="10" fill="#8b5a8c" text-anchor="middle" font-weight="600">frequency: high</text>
    </svg>
    <div class="caption"><strong>Figure 2.6.</strong> Eigenvector values visualized on the graph. Red = positive, blue = negative, gray = zero. The zero-eigenvalue mode (DC) is constant everywhere. The Fiedler vector ($\lambda_1$) gives the smoothest non-trivial variation. The two $\lambda = 4$ modes oscillate at the highest frequency the graph supports ‚Äî every edge connects vertices of different sign (or zero).</div>
  </div>

  <h4>The Graph Fourier Transform</h4>

  <p>
    Just as the classical Fourier transform decomposes a signal into sinusoidal modes of increasing frequency, the <strong>graph Fourier transform</strong> (GFT) decomposes a graph signal into eigenvector modes of increasing eigenvalue:
  </p>

  <div class="math-block">
    <div class="math-label">Graph Fourier Transform</div>
    $$\hat{\mathbf{f}} = \mathbf{P}^\top \mathbf{f} \qquad \text{(analysis: signal ‚Üí spectral coefficients)}$$
    $$\mathbf{f} = \mathbf{P}\hat{\mathbf{f}} = \sum_{i=0}^{n-1} \hat{f}_i \, \hat{\mathbf{v}}_i \qquad \text{(synthesis: spectral coefficients ‚Üí signal)}$$
  </div>

  <p>
    The spectral coefficient $\hat{f}_i = \hat{\mathbf{v}}_i^\top \mathbf{f}$ measures "how much of mode $i$ is present in the signal $\mathbf{f}$." Low-index coefficients capture smooth, global trends; high-index coefficients capture sharp, local variations.
  </p>

  <div class="figure">
    <svg viewBox="0 0 700 220" width="700" height="220">
      <text x="350" y="22" font-family="Source Sans 3" font-size="13" font-weight="700" fill="#2a2520" text-anchor="middle">Example: Decomposing the Temperature Signal T = (50, 20, 30, 10)·µÄ</text>

      <!-- Projection computation -->
      <rect x="20" y="45" width="660" height="155" rx="8" fill="#f8f4ee" stroke="#d5d0c8"/>

      <text x="40" y="72" font-family="Source Sans 3" font-size="11" font-weight="700" fill="#2a2520">Compute spectral coefficients (projections onto each eigenvector):</text>

      <text x="40" y="100" font-family="JetBrains Mono" font-size="11" fill="#b44a2f">fÃÇ‚ÇÄ = v‚ÇÄ¬∑T / ‚Äñv‚ÇÄ‚Äñ¬≤ = (50+20+30+10)/4 = <tspan font-weight="600">27.5</tspan></text>
      <text x="480" y="100" font-family="Source Sans 3" font-size="10" fill="#6b6560">‚Üê average temperature (DC component)</text>

      <text x="40" y="122" font-family="JetBrains Mono" font-size="11" fill="#2a6b5a">fÃÇ‚ÇÅ = v‚ÇÅ¬∑T / ‚Äñv‚ÇÅ‚Äñ¬≤ = (0¬∑50+1¬∑20+0¬∑30+(‚àí1)¬∑10)/2 = <tspan font-weight="600">5</tspan></text>
      <text x="480" y="122" font-family="Source Sans 3" font-size="10" fill="#6b6560">‚Üê gentle variation</text>

      <text x="40" y="144" font-family="JetBrains Mono" font-size="11" fill="#3a5a8c">fÃÇ‚ÇÇ = v‚ÇÇ¬∑T / ‚Äñv‚ÇÇ‚Äñ¬≤ = (50‚àí20+30‚àí10)/4 = <tspan font-weight="600">12.5</tspan></text>
      <text x="480" y="144" font-family="Source Sans 3" font-size="10" fill="#6b6560">‚Üê sharp checkerboard variation</text>

      <text x="40" y="166" font-family="JetBrains Mono" font-size="11" fill="#8b5a8c">fÃÇ‚ÇÉ = v‚ÇÉ¬∑T / ‚Äñv‚ÇÉ‚Äñ¬≤ = (50+0‚àí30+0)/2 = <tspan font-weight="600">10</tspan></text>
      <text x="480" y="166" font-family="Source Sans 3" font-size="10" fill="#6b6560">‚Üê sharp v‚ÇÄ-vs-v‚ÇÇ variation</text>

      <text x="40" y="192" font-family="Source Sans 3" font-size="11" fill="#2a2520" font-weight="600">Reconstruction:  T = 27.5¬∑(1,1,1,1) + 5¬∑(0,1,0,‚àí1) + 12.5¬∑(1,‚àí1,1,‚àí1) + 10¬∑(1,0,‚àí1,0) = (50, 20, 30, 10) ‚úì</text>
    </svg>
    <div class="caption"><strong>Figure 2.7.</strong> The graph Fourier transform of our temperature signal from Figure 2.4. The DC component (27.5¬∞) gives the mean temperature. The Fiedler coefficient (5) captures gentle variation. The high-frequency coefficients (12.5 and 10) capture sharp contrasts. Together they perfectly reconstruct the original signal.</div>
  </div>

  <h4>Why This Matters for Neural Networks</h4>

  <p>
    Spectral GNNs ‚Äî ChebNet, GCN, and their descendants ‚Äî define <strong>graph convolution as filtering in the spectral domain</strong>. A convolution filter $g_\theta$ applied to a signal $\mathbf{f}$ on the graph is:
  </p>

  <div class="math-block">
    <div class="math-label">Spectral Graph Convolution</div>
    $$g_\theta \star \mathbf{f} = \mathbf{P} \, g_\theta(\boldsymbol{\Lambda}) \, \mathbf{P}^\top \mathbf{f} = \mathbf{P} \begin{pmatrix} g_\theta(\lambda_0) & & \\ & \ddots & \\ & & g_\theta(\lambda_{n-1}) \end{pmatrix} \mathbf{P}^\top \mathbf{f}$$
  </div>

  <p>
    The function $g_\theta(\lambda)$ is a learnable filter that scales each frequency independently ‚Äî just like a low-pass or band-pass filter in signal processing, but with <em>learned</em> frequency response. In GCN (Kipf & Welling, 2017), the filter is simply $g_\theta(\lambda) = 1 - \lambda/\lambda_{\max}$, which attenuates high frequencies ‚Äî a smoothing operation.
  </p>

  <div class="insight key">
    <p><strong>The spectral bridge to topology:</strong> The graph Laplacian $\mathbf{L}_0$ has eigenvalues and eigenvectors that define a spectral basis for vertex signals. The Hodge Laplacian $\mathbf{L}_k$ (Section 9) does exactly the same for rank-$k$ cochains ‚Äî it provides eigenvalues (frequencies) and eigenvectors (modes) for signals on edges, faces, and volumes. Spectral topological neural networks use the Hodge eigenvectors as their Fourier basis at each rank, enabling spectral filtering of higher-order signals. This is the mathematical pipeline: Laplacian ‚Üí eigendecomposition ‚Üí Fourier basis ‚Üí learnable spectral filters.</p>
  </div>
  <h4>The Discrete de Rham Complex</h4>
  <p>
    This sign structure extends to higher ranks. The boundary matrix $\mathbf{B}_{1,2}$ (edges ‚Üí faces) encodes oriented boundaries of 2-cells and acts as a <strong>discrete curl</strong>. The full chain of boundary operators forms the <em>discrete de Rham complex</em>:
  </p>

  <div class="figure">
    <svg viewBox="0 0 680 100" width="680" height="100">
      <!-- Chain -->
      <rect x="30" y="25" width="90" height="40" rx="6" fill="#e8a88a" fill-opacity="0.3" stroke="#b44a2f" stroke-width="1.5"/>
      <text x="75" y="50" font-family="Source Sans 3" font-size="11" fill="#b44a2f" text-anchor="middle" font-weight="600">0-cochains</text>

      <text x="145" y="50" font-family="JetBrains Mono" font-size="10" fill="#6b6560" text-anchor="middle">B‚ÇÄ‚ÇÅ·µÄ</text>
      <line x1="120" y1="45" x2="160" y2="45" stroke="#6b6560" stroke-width="1.5" marker-end="url(#arrow-gray)"/>

      <rect x="170" y="25" width="90" height="40" rx="6" fill="#8ec5b6" fill-opacity="0.3" stroke="#2a6b5a" stroke-width="1.5"/>
      <text x="215" y="50" font-family="Source Sans 3" font-size="11" fill="#2a6b5a" text-anchor="middle" font-weight="600">1-cochains</text>

      <text x="285" y="50" font-family="JetBrains Mono" font-size="10" fill="#6b6560" text-anchor="middle">B‚ÇÅ‚ÇÇ·µÄ</text>
      <line x1="260" y1="45" x2="300" y2="45" stroke="#6b6560" stroke-width="1.5" marker-end="url(#arrow-gray)"/>

      <rect x="310" y="25" width="90" height="40" rx="6" fill="#a8c0e0" fill-opacity="0.3" stroke="#3a5a8c" stroke-width="1.5"/>
      <text x="355" y="50" font-family="Source Sans 3" font-size="11" fill="#3a5a8c" text-anchor="middle" font-weight="600">2-cochains</text>

      <text x="425" y="50" font-family="JetBrains Mono" font-size="10" fill="#6b6560" text-anchor="middle">B‚ÇÇ‚ÇÉ·µÄ</text>
      <line x1="400" y1="45" x2="440" y2="45" stroke="#6b6560" stroke-width="1.5" marker-end="url(#arrow-gray)"/>

      <rect x="450" y="25" width="90" height="40" rx="6" fill="#c8a8d0" fill-opacity="0.3" stroke="#8b5a8c" stroke-width="1.5"/>
      <text x="495" y="50" font-family="Source Sans 3" font-size="11" fill="#8b5a8c" text-anchor="middle" font-weight="600">3-cochains</text>

      <!-- Labels below -->
      <text x="75" y="85" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">potentials</text>
      <text x="145" y="85" font-family="Source Sans 3" font-size="10" fill="#b44a2f" text-anchor="middle" font-weight="600">grad</text>
      <text x="215" y="85" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">flows</text>
      <text x="285" y="85" font-family="Source Sans 3" font-size="10" fill="#b44a2f" text-anchor="middle" font-weight="600">curl</text>
      <text x="355" y="85" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">fluxes</text>
      <text x="425" y="85" font-family="Source Sans 3" font-size="10" fill="#b44a2f" text-anchor="middle" font-weight="600">div</text>
      <text x="495" y="85" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">densities</text>
    </svg>
    <div class="caption"><strong>Figure 2.8.</strong> The discrete de Rham complex: coboundary operators $\mathbf{B}_{k,k+1}^\top$ act as discrete gradient, curl, and divergence. The fundamental identity $\mathbf{B}_{k,k+1}^\top \mathbf{B}_{k-1,k}^\top = 0$ (curl of grad = 0, div of curl = 0) holds by construction ‚Äî it's a consequence of the signed incidence structure.</div>
  </div>

  <h3>Message Passing on Graphs</h3>
  <p>
    A GNN assigns a feature vector $\mathbf{h}_v \in \mathbb{R}^d$ to each vertex $v$ and updates features iteratively by <strong>aggregating messages from neighbors</strong>:
  </p>

  <div class="math-block">
    <div class="math-label">GNN Message Passing (one layer)</div>
    $$\mathbf{h}_v^{(\ell+1)} = \phi\!\left(\mathbf{h}_v^{(\ell)},\; \bigoplus_{w \in \mathcal{N}(v)} \psi\!\left(\mathbf{h}_v^{(\ell)}, \mathbf{h}_w^{(\ell)}\right)\right)$$
  </div>

  <p>
    Here $\mathcal{N}(v) = \{w : \{v,w\} \in E\}$ is the 1-hop neighborhood, $\psi$ computes a message, $\bigoplus$ aggregates (sum, mean, max), and $\phi$ updates. The key limitation: <strong>messages flow only between adjacent vertices along edges</strong>. There is no mechanism to send a message from an edge to a face, or from a volume to a surface.
  </p>
</section>

<hr class="divider">

<!-- ============================================================ -->
<!-- SECTION 3 -->
<!-- ============================================================ -->
<section id="sec3">
  <h2><span class="sec-num">03</span>Simplicial Complexes</h2>

  <p>
    The first natural extension of a graph is the <strong>simplicial complex</strong> ‚Äî the combinatorial object most familiar from algebraic topology and finite element methods. If you've worked with tetrahedral meshes in FEA, you already know simplicial complexes intimately; you just may not have called them that.
  </p>

  <div class="def-box green">
    <div class="def-label">Definition ‚Äî Abstract Simplicial Complex</div>
    <p>An <strong>abstract simplicial complex</strong> $\mathcal{K}$ on a vertex set $V$ is a collection of non-empty subsets of $V$ (called <strong>simplices</strong>) such that:</p>
    <p style="margin-left:1.5rem;">
      (i) For every $v \in V$, the singleton $\{v\} \in \mathcal{K}$ &nbsp; (all vertices are in $\mathcal{K}$).<br>
      (ii) If $\sigma \in \mathcal{K}$ and $\tau \subseteq \sigma$ with $\tau \neq \emptyset$, then $\tau \in \mathcal{K}$ &nbsp; (the <strong>closure property</strong>).
    </p>
    <p>A simplex $\sigma$ with $|\sigma| = k+1$ is called a <strong>$k$-simplex</strong> and has <strong>rank $k$</strong>.</p>
  </div>

  <div class="figure">
    <svg viewBox="0 0 680 280" width="680" height="280">
      <!-- 0-simplex -->
      <text x="70" y="25" font-family="Source Sans 3" font-size="12" font-weight="700" fill="#b44a2f" text-anchor="middle">0-simplex</text>
      <text x="70" y="42" font-family="Source Sans 3" font-size="11" fill="#6b6560" text-anchor="middle">(vertex)</text>
      <circle cx="70" cy="80" r="16" class="node-v" stroke-width="2.5"/>
      <text x="70" y="85" fill="white" font-family="Source Sans 3" font-size="12" text-anchor="middle" font-weight="600">v</text>
      <text x="70" y="120" font-family="Source Sans 3" font-size="11" fill="#6b6560" text-anchor="middle">{v}</text>

      <!-- 1-simplex -->
      <text x="210" y="25" font-family="Source Sans 3" font-size="12" font-weight="700" fill="#2a6b5a" text-anchor="middle">1-simplex</text>
      <text x="210" y="42" font-family="Source Sans 3" font-size="11" fill="#6b6560" text-anchor="middle">(edge)</text>
      <line x1="165" y1="80" x2="255" y2="80" stroke="#2a6b5a" stroke-width="3"/>
      <circle cx="165" cy="80" r="12" class="node-v" stroke-width="2"/>
      <circle cx="255" cy="80" r="12" class="node-v" stroke-width="2"/>
      <text x="210" y="120" font-family="Source Sans 3" font-size="11" fill="#6b6560" text-anchor="middle">{v‚ÇÄ, v‚ÇÅ}</text>

      <!-- 2-simplex -->
      <text x="380" y="25" font-family="Source Sans 3" font-size="12" font-weight="700" fill="#3a5a8c" text-anchor="middle">2-simplex</text>
      <text x="380" y="42" font-family="Source Sans 3" font-size="11" fill="#6b6560" text-anchor="middle">(triangle)</text>
      <polygon points="340,100 420,100 380,55" fill="#a8c0e0" fill-opacity="0.35" stroke="#3a5a8c" stroke-width="2"/>
      <circle cx="340" cy="100" r="10" class="node-v" stroke-width="2"/>
      <circle cx="420" cy="100" r="10" class="node-v" stroke-width="2"/>
      <circle cx="380" cy="55" r="10" class="node-v" stroke-width="2"/>
      <text x="380" y="120" font-family="Source Sans 3" font-size="11" fill="#6b6560" text-anchor="middle">{v‚ÇÄ, v‚ÇÅ, v‚ÇÇ}</text>

      <!-- 3-simplex -->
      <text x="560" y="25" font-family="Source Sans 3" font-size="12" font-weight="700" fill="#8b5a8c" text-anchor="middle">3-simplex</text>
      <text x="560" y="42" font-family="Source Sans 3" font-size="11" fill="#6b6560" text-anchor="middle">(tetrahedron)</text>
      <!-- Back face -->
      <polygon points="530,100 590,100 560,60" fill="#c8a8d0" fill-opacity="0.15" stroke="#8b5a8c" stroke-width="1"/>
      <!-- Side faces -->
      <polygon points="530,100 590,100 570,85" fill="#c8a8d0" fill-opacity="0.2" stroke="#8b5a8c" stroke-width="1"/>
      <polygon points="530,100 560,60 570,85" fill="#a8c0e0" fill-opacity="0.15" stroke="#3a5a8c" stroke-width="1"/>
      <polygon points="590,100 560,60 570,85" fill="#8ec5b6" fill-opacity="0.15" stroke="#2a6b5a" stroke-width="1"/>
      <circle cx="530" cy="100" r="8" class="node-v" stroke-width="2"/>
      <circle cx="590" cy="100" r="8" class="node-v" stroke-width="2"/>
      <circle cx="560" cy="60" r="8" class="node-v" stroke-width="2"/>
      <circle cx="570" cy="85" r="8" fill="#e8d8f0" stroke="#8b5a8c" stroke-width="2"/>
      <text x="560" y="120" font-family="Source Sans 3" font-size="11" fill="#6b6560" text-anchor="middle">{v‚ÇÄ, v‚ÇÅ, v‚ÇÇ, v‚ÇÉ}</text>

      <!-- Closure property illustration -->
      <rect x="50" y="155" width="590" height="105" rx="8" fill="#f8f4ee" stroke="#d5d0c8"/>
      <text x="70" y="180" font-family="Source Sans 3" font-size="12" font-weight="700" fill="#b44a2f">The Closure Property (Downward Closure)</text>
      <text x="70" y="200" font-family="Source Sans 3" font-size="11.5" fill="#2a2520">If the triangle {A, B, C} ‚àà ùí¶, then all its faces must also be in ùí¶:</text>
      <!-- Show the subsets -->
      <text x="100" y="230" font-family="JetBrains Mono" font-size="11" fill="#3a5a8c">{A,B,C}</text>
      <text x="190" y="230" font-family="Source Sans 3" font-size="14" fill="#b0a89e">‚äÉ</text>
      <text x="210" y="230" font-family="JetBrains Mono" font-size="11" fill="#2a6b5a">{A,B} {A,C} {B,C}</text>
      <text x="390" y="230" font-family="Source Sans 3" font-size="14" fill="#b0a89e">‚äÉ</text>
      <text x="410" y="230" font-family="JetBrains Mono" font-size="11" fill="#b44a2f">{A} {B} {C}</text>
      <text x="70" y="250" font-family="Source Sans 3" font-size="11" fill="#6b6560">You cannot have a filled triangle without its three edges and three vertices.</text>
    </svg>
    <div class="caption"><strong>Figure 3.1.</strong> The simplicial building blocks, from 0-simplices (vertices) to 3-simplices (tetrahedra). The closure property means that every face of every simplex must also be present ‚Äî you can't have a triangle without its edges.</div>
  </div>

  <h3>Why This Matters and Why It's Limiting</h3>
  <p>
    Simplicial complexes have beautiful algebraic structure ‚Äî boundary operators, chain groups, homology ‚Äî and they're the foundation of finite element methods. But they have a fundamental rigidity: <strong>a $k$-simplex always has exactly $k+1$ vertices</strong>. A 2-cell is always a triangle. A 3-cell is always a tetrahedron. This is fine for tetrahedral meshes, but overly restrictive for general deep learning.
  </p>

  <div class="insight warning">
    <p><strong>The limitation:</strong> In a simplicial complex, you cannot represent a square (4-vertex) face, a pentagonal region, or any $k$-cell with more than $k+1$ vertices. Yet many physical domains ‚Äî hexahedral mesh elements, arbitrary material regions in chip layouts, polygonal geometry ‚Äî require exactly this flexibility.</p>
  </div>
</section>

<hr class="divider">

<!-- ============================================================ -->
<!-- SECTION 4 -->
<!-- ============================================================ -->
<section id="sec4">
  <h2><span class="sec-num">04</span>Cell Complexes (CW Complexes)</h2>

  <p>
    To relax the "exactly $k+1$ vertices" constraint while preserving hierarchical structure, we turn to <strong>cell complexes</strong> ‚Äî specifically, <em>regular CW complexes</em>.
  </p>

  <div class="def-box blue">
    <div class="def-label">Definition ‚Äî (Regular) Cell Complex</div>
    <p>A <strong>regular cell complex</strong> $\mathcal{X}$ is a topological space decomposed into cells $\{e_\alpha^k\}$ of various dimensions $k$, such that:</p>
    <p style="margin-left:1.5rem;">
      (i) Each $k$-cell $e_\alpha^k$ is homeomorphic to an open $k$-disk.<br>
      (ii) The boundary of each $k$-cell is a union of lower-dimensional cells in $\mathcal{X}$.<br>
      (iii) (Regularity) The attaching map of each cell is a homeomorphism on the boundary.
    </p>
  </div>

  <p>
    The key relaxation: a 2-cell in a cell complex can be a square, a pentagon, a hexagon ‚Äî any polygon. It only needs to be bounded by 1-cells (edges) and 0-cells (vertices).
  </p>

  <div class="figure">
    <svg viewBox="0 0 650 200" width="650" height="200">
      <!-- Simplicial -->
      <text x="140" y="20" font-family="Source Sans 3" font-size="12" font-weight="700" fill="#3a5a8c" text-anchor="middle">Simplicial Complex</text>
      <!-- Two triangles sharing an edge -->
      <polygon points="60,80 140,50 140,120" fill="#a8c0e0" fill-opacity="0.3" stroke="#3a5a8c" stroke-width="1.5"/>
      <polygon points="140,50 220,80 140,120" fill="#a8c0e0" fill-opacity="0.2" stroke="#3a5a8c" stroke-width="1.5"/>
      <circle cx="60" cy="80" r="8" class="node-v" stroke-width="2"/>
      <circle cx="140" cy="50" r="8" class="node-v" stroke-width="2"/>
      <circle cx="140" cy="120" r="8" class="node-v" stroke-width="2"/>
      <circle cx="220" cy="80" r="8" class="node-v" stroke-width="2"/>
      <text x="140" y="165" font-family="Source Sans 3" font-size="11" fill="#6b6560" text-anchor="middle">2-cells must be triangles</text>

      <!-- Arrow -->
      <text x="310" y="90" font-family="Source Sans 3" font-size="22" fill="#b0a89e" text-anchor="middle">vs.</text>

      <!-- CW -->
      <text x="490" y="20" font-family="Source Sans 3" font-size="12" font-weight="700" fill="#8b5a8c" text-anchor="middle">Cell Complex</text>
      <!-- A square cell -->
      <rect x="400" y="45" width="80" height="80" rx="2" fill="#c8a8d0" fill-opacity="0.25" stroke="#8b5a8c" stroke-width="1.5"/>
      <!-- A pentagon cell -->
      <polygon points="510,60 560,50 580,90 555,130 515,120" fill="#8ec5b6" fill-opacity="0.2" stroke="#2a6b5a" stroke-width="1.5"/>
      <circle cx="400" cy="45" r="6" class="node-v" stroke-width="1.5"/>
      <circle cx="480" cy="45" r="6" class="node-v" stroke-width="1.5"/>
      <circle cx="480" cy="125" r="6" class="node-v" stroke-width="1.5"/>
      <circle cx="400" cy="125" r="6" class="node-v" stroke-width="1.5"/>
      <circle cx="510" cy="60" r="6" class="node-v" stroke-width="1.5"/>
      <circle cx="560" cy="50" r="6" class="node-v" stroke-width="1.5"/>
      <circle cx="580" cy="90" r="6" class="node-v" stroke-width="1.5"/>
      <circle cx="555" cy="130" r="6" class="node-v" stroke-width="1.5"/>
      <circle cx="515" cy="120" r="6" class="node-v" stroke-width="1.5"/>
      <text x="440" y="90" class="label-sm" fill="#8b5a8c" font-weight="600">‚ñ°</text>
      <text x="545" y="92" class="label-sm" fill="#2a6b5a" font-weight="600">‚¨†</text>
      <text x="490" y="165" font-family="Source Sans 3" font-size="11" fill="#6b6560" text-anchor="middle">2-cells can be any polygon</text>
    </svg>
    <div class="caption"><strong>Figure 4.1.</strong> Simplicial complexes require all 2-cells to be triangles. Cell complexes allow squares, pentagons, arbitrary polygons ‚Äî any shape bounded by edges.</div>
  </div>

  <p>
    Cell complexes relax the <em>geometric</em> restriction of simplices but retain the <strong>topological inclusion constraint</strong>: the boundary of every $k$-cell must be composed of $(k\!-\!1)$-cells that are already in the complex. This is the cell-complex version of closure: you can have a square face, but all four of its bounding edges must be present.
  </p>

  <div class="insight">
    <p><strong>FEA connection:</strong> If you've worked with hexahedral or mixed-element FEM meshes, you've already been working with cell complexes. A hex mesh uses 3-cells (cubes/hexahedra) whose boundaries are quadrilateral 2-cells ‚Äî impossible in a simplicial complex.</p>
  </div>
</section>

<hr class="divider">

<!-- ============================================================ -->
<!-- SECTION 5 -->
<!-- ============================================================ -->
<section id="sec5">
  <h2><span class="sec-num">05</span>Combinatorial Complexes</h2>

  <p>
    This is the central construction of the Hajij et al. paper and the key innovation. A <strong>combinatorial complex</strong> (CC) relaxes both the rigid geometry of simplicial complexes <em>and</em> the strict boundary requirements of cell complexes.
  </p>

  <div class="def-box purple">
    <div class="def-label">Definition ‚Äî Combinatorial Complex</div>
    <p>A <strong>combinatorial complex</strong> $(S, \mathcal{X}, \text{rk})$ consists of:</p>
    <p style="margin-left:1.5rem;">
      &bull; A finite set $S$ (the vertex set)<br>
      &bull; A set $\mathcal{X} \subseteq \mathcal{P}(S) \setminus \{\emptyset\}$ of non-empty subsets of $S$ (the cells)<br>
      &bull; A rank function $\text{rk}: \mathcal{X} \to \mathbb{Z}_{\geq 0}$
    </p>
    <p>satisfying two axioms:</p>
    <p style="margin-left:1.5rem;">
      <strong>(CC1)</strong> For all $s \in S$: $\{s\} \in \mathcal{X}$ and $\text{rk}(\{s\}) = 0$ &nbsp; (every vertex is a rank-0 cell).<br>
      <strong>(CC2)</strong> If $x, y \in \mathcal{X}$ with $x \subsetneq y$, then $\text{rk}(x) < \text{rk}(y)$ &nbsp; (<strong>rank respects inclusion</strong>).
    </p>
  </div>

  <p>
    Axiom CC2 is the crucial design choice. It says: if one cell is <em>strictly contained</em> in another (as a set of vertices), the contained cell must have strictly lower rank. But ‚Äî critically ‚Äî <strong>it does not require every face of a cell to be present</strong>.
  </p>

  <div class="figure">
    <svg viewBox="0 0 700 320" width="700" height="320">
      <!-- Title -->
      <text x="350" y="22" font-family="Source Sans 3" font-size="13" font-weight="700" fill="#2a2520" text-anchor="middle">Comparison: What Must Be Present?</text>

      <!-- SIMPLICIAL -->
      <rect x="15" y="40" width="210" height="260" rx="8" fill="white" stroke="#d5d0c8"/>
      <text x="120" y="65" font-family="Source Sans 3" font-size="12" font-weight="700" fill="#3a5a8c" text-anchor="middle">Simplicial Complex</text>
      <!-- Triangle with all edges -->
      <polygon points="70,130 170,110 130,190" fill="#a8c0e0" fill-opacity="0.3" stroke="#3a5a8c" stroke-width="1.5"/>
      <line x1="70" y1="130" x2="170" y2="110" stroke="#2a6b5a" stroke-width="2"/>
      <line x1="170" y1="110" x2="130" y2="190" stroke="#2a6b5a" stroke-width="2"/>
      <line x1="130" y1="190" x2="70" y2="130" stroke="#2a6b5a" stroke-width="2"/>
      <circle cx="70" cy="130" r="8" class="node-v" stroke-width="2"/>
      <circle cx="170" cy="110" r="8" class="node-v" stroke-width="2"/>
      <circle cx="130" cy="190" r="8" class="node-v" stroke-width="2"/>
      <text x="120" y="230" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" text-anchor="middle">‚úì Triangle ‚Üí all 3 edges</text>
      <text x="120" y="248" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" text-anchor="middle">‚úì All edges ‚Üí all 3 vertices</text>
      <text x="120" y="266" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" text-anchor="middle">‚úì Only triangular faces</text>
      <text x="120" y="286" font-family="Source Sans 3" font-size="10.5" fill="#b44a2f" text-anchor="middle" font-weight="600">Full downward closure</text>

      <!-- CELL -->
      <rect x="245" y="40" width="210" height="260" rx="8" fill="white" stroke="#d5d0c8"/>
      <text x="350" y="65" font-family="Source Sans 3" font-size="12" font-weight="700" fill="#8b5a8c" text-anchor="middle">Cell Complex</text>
      <!-- Square with all edges -->
      <rect x="290" y="100" width="80" height="80" rx="1" fill="#c8a8d0" fill-opacity="0.25" stroke="#8b5a8c" stroke-width="1.5"/>
      <line x1="290" y1="100" x2="370" y2="100" stroke="#2a6b5a" stroke-width="2"/>
      <line x1="370" y1="100" x2="370" y2="180" stroke="#2a6b5a" stroke-width="2"/>
      <line x1="370" y1="180" x2="290" y2="180" stroke="#2a6b5a" stroke-width="2"/>
      <line x1="290" y1="180" x2="290" y2="100" stroke="#2a6b5a" stroke-width="2"/>
      <circle cx="290" cy="100" r="7" class="node-v" stroke-width="2"/>
      <circle cx="370" cy="100" r="7" class="node-v" stroke-width="2"/>
      <circle cx="370" cy="180" r="7" class="node-v" stroke-width="2"/>
      <circle cx="290" cy="180" r="7" class="node-v" stroke-width="2"/>
      <text x="350" y="230" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" text-anchor="middle">‚úì Square face ‚Üí all 4 edges</text>
      <text x="350" y="248" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" text-anchor="middle">‚úì All edges ‚Üí all 4 vertices</text>
      <text x="350" y="266" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" text-anchor="middle">‚úì Arbitrary polygon faces</text>
      <text x="350" y="286" font-family="Source Sans 3" font-size="10.5" fill="#8b5a8c" text-anchor="middle" font-weight="600">Boundary must be present</text>

      <!-- COMBINATORIAL -->
      <rect x="475" y="40" width="210" height="260" rx="8" fill="white" stroke="#d5d0c8"/>
      <text x="580" y="65" font-family="Source Sans 3" font-size="12" font-weight="700" fill="#b44a2f" text-anchor="middle">Combinatorial Complex</text>
      <!-- Blob around 4 vertices, missing an edge -->
      <path d="M 530,110 Q 555,85 600,100 Q 625,130 610,170 Q 580,195 540,180 Q 515,150 530,110 Z" fill="#e8a88a" fill-opacity="0.2" stroke="#b44a2f" stroke-width="1.5"/>
      <line x1="540" y1="115" x2="600" y2="105" stroke="#2a6b5a" stroke-width="2"/>
      <line x1="600" y1="105" x2="605" y2="165" stroke="#2a6b5a" stroke-width="2"/>
      <line x1="540" y1="115" x2="550" y2="175" stroke="#2a6b5a" stroke-width="2"/>
      <!-- Missing edge: 550,175 to 605,165 ‚Äî shown as dashed -->
      <line x1="550" y1="175" x2="605" y2="165" stroke="#b44a2f" stroke-width="1.5" stroke-dasharray="4,4" opacity="0.5"/>
      <circle cx="540" cy="115" r="7" class="node-v" stroke-width="2"/>
      <circle cx="600" cy="105" r="7" class="node-v" stroke-width="2"/>
      <circle cx="605" cy="165" r="7" class="node-v" stroke-width="2"/>
      <circle cx="550" cy="175" r="7" class="node-v" stroke-width="2"/>
      <text x="572" y="145" class="label-sm" fill="#b44a2f" font-weight="600">rank 2</text>
      <text x="580" y="230" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" text-anchor="middle">‚úì 4-vertex rank-2 cell</text>
      <text x="580" y="248" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" text-anchor="middle">‚úó Bottom edge can be missing!</text>
      <text x="580" y="266" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" text-anchor="middle">‚úì Any number of vertices per cell</text>
      <text x="580" y="286" font-family="Source Sans 3" font-size="10.5" fill="#b44a2f" text-anchor="middle" font-weight="600">Only: inclusion ‚Üí lower rank</text>
    </svg>
    <div class="caption"><strong>Figure 5.1.</strong> The three levels of generality. Simplicial: full closure, fixed shapes. Cell: full boundary, flexible shapes. Combinatorial: only rank-monotonicity on inclusion, maximum flexibility. The dashed line in the CC shows a "missing" edge ‚Äî the rank-2 cell spans 4 vertices even though not all pairs share an edge.</div>
  </div>

  <h3>Why CCs Are the Right Abstraction for Neural Networks</h3>

  <p>The key insight is that in deep learning, we don't need the full topological structure that algebraic topologists care about (homology, homotopy). We need a <strong>computationally tractable way to define neighborhoods, pass messages between cells of different ranks, and aggregate information hierarchically</strong>. Combinatorial complexes provide exactly this, with minimal structural overhead.</p>

  <table class="comp-table">
    <thead>
      <tr>
        <th>Property</th>
        <th>Simplicial</th>
        <th>Cell</th>
        <th>Combinatorial</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>$k$-cell vertex count</td>
        <td>Exactly $k+1$</td>
        <td>Any ‚â• $k+1$</td>
        <td>Any ‚â• 1</td>
      </tr>
      <tr>
        <td>Closure / boundary</td>
        <td>Full downward closure</td>
        <td>Boundary cells required</td>
        <td>None required</td>
      </tr>
      <tr>
        <td>Rank constraint</td>
        <td>$\text{rk}(\sigma) = |\sigma| - 1$</td>
        <td>Dimension from topology</td>
        <td>$x \subsetneq y \Rightarrow \text{rk}(x) < \text{rk}(y)$</td>
      </tr>
      <tr>
        <td>Hypergraph superset?</td>
        <td>No</td>
        <td>No</td>
        <td><strong>Yes</strong> ‚Äî every hypergraph is a CC</td>
      </tr>
      <tr>
        <td>Simplicial superset?</td>
        <td>‚Äî</td>
        <td>Yes</td>
        <td><strong>Yes</strong></td>
      </tr>
    </tbody>
  </table>

  <div class="insight key">
    <p><strong>The crucial generalization:</strong> A combinatorial complex subsumes both simplicial complexes and hypergraphs as special cases. This means any neural network architecture defined on a CC automatically works on graphs, simplicial complexes, cell complexes, and hypergraphs.</p>
  </div>
</section>

<hr class="divider">

<!-- ============================================================ -->
<!-- SECTION 6 -->
<!-- ============================================================ -->
<section id="sec6">
  <h2><span class="sec-num">06</span>Signals, Cochains &amp; Feature Spaces</h2>

  <p>
    With the domain structure (the complex) established, we now need to put <strong>data on it</strong>. In physics, you assign fields to points (scalar fields), curves (line integrals), surfaces (flux), and volumes (densities). The discrete version of this is a <strong>cochain</strong>.
  </p>

  <div class="def-box green">
    <div class="def-label">Definition ‚Äî $k$-Cochain</div>
    <p>Let $\mathcal{X}_k$ denote the set of all rank-$k$ cells in a CC. A <strong>$k$-cochain</strong> is a function $\mathbf{h}: \mathcal{X}_k \to \mathbb{R}^{d_k}$ assigning a feature vector to each rank-$k$ cell. The space of all $k$-cochains is $C^k(\mathcal{X}; \mathbb{R}^{d_k}) \cong \mathbb{R}^{|\mathcal{X}_k| \times d_k}$.</p>
  </div>

  <div class="figure">
    <svg viewBox="0 0 650 250" width="650" height="250">
      <!-- A small complex with features labeled -->
      <text x="170" y="22" font-family="Source Sans 3" font-size="13" font-weight="700" fill="#2a2520" text-anchor="middle">Features on a Complex</text>

      <!-- 2-cell (filled region) -->
      <polygon points="80,100 200,70 230,160 120,180" fill="#a8c0e0" fill-opacity="0.2" stroke="#3a5a8c" stroke-width="1.5"/>

      <!-- Edges -->
      <line x1="80" y1="100" x2="200" y2="70" stroke="#2a6b5a" stroke-width="2.5"/>
      <line x1="200" y1="70" x2="230" y2="160" stroke="#2a6b5a" stroke-width="2.5"/>
      <line x1="230" y1="160" x2="120" y2="180" stroke="#2a6b5a" stroke-width="2.5"/>
      <line x1="120" y1="180" x2="80" y2="100" stroke="#2a6b5a" stroke-width="2.5"/>
      <line x1="80" y1="100" x2="50" y2="190" stroke="#2a6b5a" stroke-width="2.5"/>

      <!-- Vertices -->
      <circle cx="80" cy="100" r="12" class="node-v" stroke-width="2"/>
      <circle cx="200" cy="70" r="12" class="node-v" stroke-width="2"/>
      <circle cx="230" cy="160" r="12" class="node-v" stroke-width="2"/>
      <circle cx="120" cy="180" r="12" class="node-v" stroke-width="2"/>
      <circle cx="50" cy="190" r="12" class="node-v" stroke-width="2"/>

      <!-- Feature annotations -->
      <!-- Vertex features -->
      <rect x="270" y="55" width="150" height="26" rx="4" fill="#e8a88a" fill-opacity="0.3" stroke="#b44a2f"/>
      <text x="345" y="73" font-family="Source Sans 3" font-size="11" fill="#b44a2f" text-anchor="middle" font-weight="600">0-cochain: h‚Å∞ ‚àà ‚Ñù‚ÅµÀ£·µà‚Å∞</text>
      <text x="345" y="95" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" text-anchor="middle">e.g., material type, temperature</text>

      <!-- Edge features -->
      <rect x="270" y="115" width="150" height="26" rx="4" fill="#8ec5b6" fill-opacity="0.3" stroke="#2a6b5a"/>
      <text x="345" y="133" font-family="Source Sans 3" font-size="11" fill="#2a6b5a" text-anchor="middle" font-weight="600">1-cochain: h¬π ‚àà ‚Ñù‚ÅµÀ£·µà¬π</text>
      <text x="345" y="155" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" text-anchor="middle">e.g., contact conductance, flux</text>

      <!-- Face features -->
      <rect x="270" y="175" width="150" height="26" rx="4" fill="#a8c0e0" fill-opacity="0.3" stroke="#3a5a8c"/>
      <text x="345" y="193" font-family="Source Sans 3" font-size="11" fill="#3a5a8c" text-anchor="middle" font-weight="600">2-cochain: h¬≤ ‚àà ‚Ñù¬πÀ£·µà¬≤</text>
      <text x="345" y="215" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" text-anchor="middle">e.g., eff. conductivity tensor</text>

      <!-- Arrows -->
      <line x1="95" y1="92" x2="268" y2="68" stroke="#b44a2f" stroke-width="0.8" stroke-dasharray="3,3"/>
      <line x1="150" y1="85" x2="268" y2="128" stroke="#2a6b5a" stroke-width="0.8" stroke-dasharray="3,3"/>
      <line x1="160" y1="130" x2="268" y2="188" stroke="#3a5a8c" stroke-width="0.8" stroke-dasharray="3,3"/>
    </svg>
    <div class="caption"><strong>Figure 6.1.</strong> A cochain assigns feature vectors to cells of each rank. Crucially, the feature dimension $d_k$ can differ by rank ‚Äî vertex features (material properties at a point) can have different dimensionality than edge features (interface properties) or face features (effective tensor properties).</div>
  </div>

  <div class="insight physics">
    <p><strong>Physics connection:</strong> This is exactly the discrete de Rham complex. In EM, 0-cochains correspond to scalar potentials at nodes, 1-cochains to line integrals of the vector potential along edges, 2-cochains to magnetic flux through faces, and 3-cochains to charge density in volumes. The TDL framework generalizes this by allowing <em>learned</em> feature vectors instead of single scalars.</p>
  </div>

  <h3>The Full State of a CC</h3>
  <p>
    The complete state of a CC with maximum rank $K$ is a tuple of cochains at each rank:
  </p>

  <div class="math-block">
    <div class="math-label">State of a Combinatorial Complex</div>
    $$\mathbf{H} = \left(\mathbf{H}^{(0)}, \, \mathbf{H}^{(1)}, \, \ldots, \, \mathbf{H}^{(K)}\right) \quad \text{where} \quad \mathbf{H}^{(k)} \in \mathbb{R}^{|\mathcal{X}_k| \times d_k}$$
  </div>

  <p>
    Each row of $\mathbf{H}^{(k)}$ is the feature vector of one rank-$k$ cell. A topological neural network layer takes this full tuple as input and produces an updated tuple as output ‚Äî it updates features <em>across all ranks simultaneously</em>.
  </p>
</section>

<hr class="divider">

<!-- ============================================================ -->
<!-- SECTION 7 -->
<!-- ============================================================ -->
<section id="sec7">
  <h2><span class="sec-num">07</span>Neighborhood &amp; Adjacency</h2>

  <p>
    In a graph, the neighborhood of a node is simple: the set of nodes connected by an edge. In a CC, there are <strong>many possible notions of neighborhood</strong>, because cells can be related by sharing vertices, sharing boundaries, or being contained in one another. The Hajij et al. paper systematically catalogs these.
  </p>

  <h3>Three Types of Adjacency</h3>

  <div class="figure">
    <svg viewBox="0 0 700 350" width="700" height="350">
      <!-- Type 1: Co-adjacency (same rank, share a lower cell) -->
      <rect x="15" y="10" width="210" height="320" rx="8" fill="white" stroke="#d5d0c8"/>
      <text x="120" y="38" font-family="Source Sans 3" font-size="12" font-weight="700" fill="#b44a2f" text-anchor="middle">(Co-)Adjacency</text>
      <text x="120" y="56" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" text-anchor="middle">Same rank, share a boundary cell</text>

      <!-- Two triangles sharing an edge -->
      <polygon points="50,130 130,100 110,180" fill="#a8c0e0" fill-opacity="0.3" stroke="#3a5a8c" stroke-width="1.5"/>
      <polygon points="130,100 190,140 110,180" fill="#8ec5b6" fill-opacity="0.25" stroke="#2a6b5a" stroke-width="1.5"/>
      <!-- Shared edge highlighted -->
      <line x1="130" y1="100" x2="110" y2="180" stroke="#b44a2f" stroke-width="3"/>
      <circle cx="50" cy="130" r="6" class="node-v" stroke-width="1.5"/>
      <circle cx="130" cy="100" r="6" class="node-v" stroke-width="1.5"/>
      <circle cx="110" cy="180" r="6" class="node-v" stroke-width="1.5"/>
      <circle cx="190" cy="140" r="6" class="node-v" stroke-width="1.5"/>
      <text x="90" y="145" font-family="Source Sans 3" font-size="9" fill="#3a5a8c" font-weight="600">œÉ‚ÇÅ</text>
      <text x="150" y="145" font-family="Source Sans 3" font-size="9" fill="#2a6b5a" font-weight="600">œÉ‚ÇÇ</text>

      <!-- Arrows showing message -->
      <path d="M 85,152 C 100,170 130,170 148,152" stroke="#b44a2f" stroke-width="1.5" fill="none" marker-end="url(#arrow-red)"/>

      <text x="120" y="220" font-family="Source Sans 3" font-size="10.5" fill="#2a2520" text-anchor="middle">œÉ‚ÇÅ and œÉ‚ÇÇ are <tspan font-style="italic">adjacent</tspan></text>
      <text x="120" y="240" font-family="Source Sans 3" font-size="10.5" fill="#2a2520" text-anchor="middle">(both rank 2, share an edge)</text>
      <text x="120" y="275" font-family="JetBrains Mono" font-size="10" fill="#b44a2f" text-anchor="middle">A_{k,k} matrix</text>
      <text x="120" y="295" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">e.g., graph adjacency A</text>
      <text x="120" y="310" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">is A_{0,0} via shared edges</text>

      <!-- Type 2: Incidence (cross-rank: boundary/coboundary) -->
      <rect x="245" y="10" width="210" height="320" rx="8" fill="white" stroke="#d5d0c8"/>
      <text x="350" y="38" font-family="Source Sans 3" font-size="12" font-weight="700" fill="#2a6b5a" text-anchor="middle">Incidence</text>
      <text x="350" y="56" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" text-anchor="middle">Cross-rank: cell ‚äÇ higher cell</text>

      <!-- Triangle with an edge highlighted as boundary -->
      <polygon points="290,130 370,100 350,190" fill="#a8c0e0" fill-opacity="0.25" stroke="#3a5a8c" stroke-width="1.5"/>
      <line x1="290" y1="130" x2="370" y2="100" stroke="#2a6b5a" stroke-width="3"/>
      <circle cx="290" cy="130" r="6" class="node-v" stroke-width="1.5"/>
      <circle cx="370" cy="100" r="6" class="node-v" stroke-width="1.5"/>
      <circle cx="350" cy="190" r="6" class="node-v" stroke-width="1.5"/>
      <text x="330" y="152" font-family="Source Sans 3" font-size="9" fill="#3a5a8c" font-weight="600">œÉ (rank 2)</text>
      <text x="340" y="105" font-family="Source Sans 3" font-size="9" fill="#2a6b5a" font-weight="600">œÑ (rank 1)</text>

      <!-- Arrow: edge ‚Üí face -->
      <path d="M 342,110 L 335,135" stroke="#2a6b5a" stroke-width="2" fill="none" marker-end="url(#arrow-green)"/>
      <text x="358" y="128" font-family="Source Sans 3" font-size="9" fill="#2a6b5a">œÑ ‚äÇ œÉ</text>

      <text x="350" y="220" font-family="Source Sans 3" font-size="10.5" fill="#2a2520" text-anchor="middle">œÑ is <tspan font-style="italic">incident</tspan> to œÉ</text>
      <text x="350" y="240" font-family="Source Sans 3" font-size="10.5" fill="#2a2520" text-anchor="middle">(œÑ is on œÉ's boundary)</text>
      <text x="350" y="275" font-family="JetBrains Mono" font-size="10" fill="#2a6b5a" text-anchor="middle">B_{k,k+1} matrix</text>
      <text x="350" y="295" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">boundary: rank k+1 ‚Üí rank k</text>
      <text x="350" y="310" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">coboundary: rank k ‚Üí rank k+1</text>

      <!-- Type 3: Upper/Lower adjacency via shared higher/lower cell -->
      <rect x="475" y="10" width="210" height="320" rx="8" fill="white" stroke="#d5d0c8"/>
      <text x="580" y="38" font-family="Source Sans 3" font-size="12" font-weight="700" fill="#8b5a8c" text-anchor="middle">Upper/Lower Adjacency</text>
      <text x="580" y="56" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" text-anchor="middle">Same rank, share a higher cell</text>

      <!-- Three edges that share a common face -->
      <polygon points="520,140 620,110 600,200" fill="#c8a8d0" fill-opacity="0.15" stroke="#8b5a8c" stroke-width="1" stroke-dasharray="4,3"/>
      <line x1="520" y1="140" x2="620" y2="110" stroke="#2a6b5a" stroke-width="2.5"/>
      <line x1="620" y1="110" x2="600" y2="200" stroke="#2a6b5a" stroke-width="2.5"/>
      <line x1="600" y1="200" x2="520" y2="140" stroke="#2a6b5a" stroke-width="2.5"/>
      <circle cx="520" cy="140" r="6" class="node-v" stroke-width="1.5"/>
      <circle cx="620" cy="110" r="6" class="node-v" stroke-width="1.5"/>
      <circle cx="600" cy="200" r="6" class="node-v" stroke-width="1.5"/>
      <text x="565" y="115" font-family="Source Sans 3" font-size="9" fill="#2a6b5a" font-weight="600">e‚ÇÅ</text>
      <text x="620" y="160" font-family="Source Sans 3" font-size="9" fill="#2a6b5a" font-weight="600">e‚ÇÇ</text>
      <text x="555" y="180" font-family="Source Sans 3" font-size="9" fill="#2a6b5a" font-weight="600">e‚ÇÉ</text>

      <path d="M 560,120 C 575,100 595,108 615,125" stroke="#8b5a8c" stroke-width="1.5" fill="none" stroke-dasharray="4,3"/>

      <text x="580" y="225" font-family="Source Sans 3" font-size="10.5" fill="#2a2520" text-anchor="middle">e‚ÇÅ and e‚ÇÇ are <tspan font-style="italic">upper-adjacent</tspan></text>
      <text x="580" y="245" font-family="Source Sans 3" font-size="10.5" fill="#2a2520" text-anchor="middle">(both rank 1, co-faces of œÉ)</text>
      <text x="580" y="275" font-family="JetBrains Mono" font-size="10" fill="#8b5a8c" text-anchor="middle">coA_{k,k} = B¬∑B·µÄ</text>
      <text x="580" y="295" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">Lower adj: share a face</text>
      <text x="580" y="310" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">Upper adj: share a coface</text>

      <!-- Arrow markers -->
      <defs>
        <marker id="arrow-red" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
          <path d="M 0 0 L 10 5 L 0 10 z" fill="#b44a2f"/>
        </marker>
        <marker id="arrow-green" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
          <path d="M 0 0 L 10 5 L 0 10 z" fill="#2a6b5a"/>
        </marker>
      </defs>
    </svg>
    <div class="caption"><strong>Figure 7.1.</strong> Three types of adjacency in a topological domain. <strong>Co-adjacency</strong> (same rank, shared lower cell) generalizes the graph adjacency matrix. <strong>Incidence</strong> (cross-rank containment) captures the boundary/coboundary relationship. <strong>Upper/lower adjacency</strong> (same rank, shared higher/lower cell) enables message passing mediated by higher-order context.</div>
  </div>

  <h3>The Neighborhood Matrix Zoo</h3>
  <p>For a CC with ranks 0, 1, ..., $K$, the paper defines a rich set of matrices encoding different neighborhood relations. The most important ones:</p>

  <table class="comp-table">
    <thead>
      <tr><th>Matrix</th><th>Dimension</th><th>Meaning</th></tr>
    </thead>
    <tbody>
      <tr>
        <td>$\mathbf{B}_{k,k+1}$</td>
        <td>$|\mathcal{X}_k| \times |\mathcal{X}_{k+1}|$</td>
        <td>Incidence: which $k$-cells are on the boundary of which $(k\!+\!1)$-cells</td>
      </tr>
      <tr>
        <td>$\mathbf{A}_{k,\downarrow} = \mathbf{B}_{k-1,k}^\top \mathbf{B}_{k-1,k}$</td>
        <td>$|\mathcal{X}_k| \times |\mathcal{X}_k|$</td>
        <td>Lower adjacency: $k$-cells sharing a $(k\!-\!1)$-cell boundary</td>
      </tr>
      <tr>
        <td>$\mathbf{A}_{k,\uparrow} = \mathbf{B}_{k,k+1} \mathbf{B}_{k,k+1}^\top$</td>
        <td>$|\mathcal{X}_k| \times |\mathcal{X}_k|$</td>
        <td>Upper adjacency: $k$-cells sharing a $(k\!+\!1)$-cell coface</td>
      </tr>
    </tbody>
  </table>

  <div class="insight">
    <p><strong>Standard graph adjacency is a special case.</strong> The usual graph adjacency matrix $\mathbf{A}$ is the upper adjacency of rank-0 cells (vertices) via rank-1 cells (edges): $\mathbf{A} = \mathbf{A}_{0,\uparrow} = \mathbf{B}_{0,1}\mathbf{B}_{0,1}^\top$. The entire GNN framework operates with just this one matrix. Topological deep learning opens up all the others.</p>
  </div>
</section>

<hr class="divider">

<!-- ============================================================ -->
<!-- SECTION 8 -->
<!-- ============================================================ -->
<section id="sec8">
  <h2><span class="sec-num">08</span>Higher-Order Message Passing</h2>

  <p>
    With the neighborhood structure defined, we can now write down the general message-passing scheme on a CC. This is the paper's main contribution: a <strong>unified framework</strong> for updating features on cells of any rank, using messages from cells of any rank.
  </p>

  <h3>The General Update Rule</h3>
  <p>
    For a rank-$k$ cell $x$, the update at layer $\ell$ aggregates messages from multiple neighborhood types:
  </p>

  <div class="math-block">
    <div class="math-label">Higher-Order Message Passing (HOMP)</div>
    $$\mathbf{h}_x^{(k, \ell+1)} = \text{AGG}\!\left(\mathbf{h}_x^{(k,\ell)}, \;\; \bigoplus_{\mathcal{N} \in \{\mathcal{N}_\downarrow, \mathcal{N}_\uparrow, \mathcal{N}_{\text{adj}}, \mathcal{N}_{\text{inc}}\}} \bigoplus_{y \in \mathcal{N}(x)} m_\mathcal{N}\!\left(\mathbf{h}_x^{(k,\ell)},\, \mathbf{h}_y^{(r_y, \ell)}\right)\right)$$
  </div>

  <p>where the neighborhoods include:</p>

  <div class="figure">
    <svg viewBox="0 0 700 300" width="700" height="300">
      <!-- Central cell -->
      <rect x="280" y="120" width="140" height="50" rx="8" fill="#e8a88a" fill-opacity="0.4" stroke="#b44a2f" stroke-width="2"/>
      <text x="350" y="150" font-family="Source Sans 3" font-size="12" font-weight="700" fill="#b44a2f" text-anchor="middle">Cell x (rank k)</text>

      <!-- Lower cells (rank k-1) -->
      <rect x="50" y="220" width="130" height="40" rx="6" fill="#8ec5b6" fill-opacity="0.3" stroke="#2a6b5a" stroke-width="1.5"/>
      <text x="115" y="245" font-family="Source Sans 3" font-size="11" fill="#2a6b5a" text-anchor="middle" font-weight="600">Boundary (rank k‚àí1)</text>
      <path d="M 115,220 Q 150,180 280,145" stroke="#2a6b5a" stroke-width="1.5" fill="none" marker-end="url(#arrow-green)"/>
      <text x="170" y="175" font-family="Source Sans 3" font-size="10" fill="#2a6b5a" font-weight="600">ùí©‚Üì</text>

      <!-- Upper cells (rank k+1) -->
      <rect x="50" y="20" width="130" height="40" rx="6" fill="#a8c0e0" fill-opacity="0.3" stroke="#3a5a8c" stroke-width="1.5"/>
      <text x="115" y="45" font-family="Source Sans 3" font-size="11" fill="#3a5a8c" text-anchor="middle" font-weight="600">Cofaces (rank k+1)</text>
      <path d="M 115,60 Q 150,100 280,140" stroke="#3a5a8c" stroke-width="1.5" fill="none" marker-end="url(#arrow-green)"/>
      <text x="170" y="105" font-family="Source Sans 3" font-size="10" fill="#3a5a8c" font-weight="600">ùí©‚Üë</text>

      <!-- Same-rank neighbors (lower adj) -->
      <rect x="520" y="50" width="150" height="40" rx="6" fill="#c8a8d0" fill-opacity="0.3" stroke="#8b5a8c" stroke-width="1.5"/>
      <text x="595" y="75" font-family="Source Sans 3" font-size="11" fill="#8b5a8c" text-anchor="middle" font-weight="600">Lower-adj (rank k)</text>
      <path d="M 520,70 Q 470,90 420,135" stroke="#8b5a8c" stroke-width="1.5" fill="none" marker-end="url(#arrow-green)"/>
      <text x="480" y="95" font-family="Source Sans 3" font-size="10" fill="#8b5a8c" font-weight="600">ùí©adj,‚Üì</text>

      <!-- Same-rank neighbors (upper adj) -->
      <rect x="520" y="200" width="150" height="40" rx="6" fill="#e8d8a8" fill-opacity="0.4" stroke="#8b7a3c" stroke-width="1.5"/>
      <text x="595" y="225" font-family="Source Sans 3" font-size="11" fill="#8b7a3c" text-anchor="middle" font-weight="600">Upper-adj (rank k)</text>
      <path d="M 520,220 Q 470,190 420,160" stroke="#8b7a3c" stroke-width="1.5" fill="none" marker-end="url(#arrow-green)"/>
      <text x="480" y="195" font-family="Source Sans 3" font-size="10" fill="#8b7a3c" font-weight="600">ùí©adj,‚Üë</text>

      <!-- Legend bar -->
      <rect x="100" y="275" width="500" height="22" rx="4" fill="#f8f4ee" stroke="#d5d0c8"/>
      <text x="350" y="291" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" text-anchor="middle">Each arrow represents a separate message-passing channel with its own learnable parameters</text>
    </svg>
    <div class="caption"><strong>Figure 8.1.</strong> A rank-$k$ cell receives messages from four types of neighborhoods: boundary cells (rank $k\!-\!1$), coface cells (rank $k\!+\!1$), lower-adjacent same-rank cells (sharing a boundary cell), and upper-adjacent same-rank cells (sharing a coface). Each channel has independent learnable weights.</div>
  </div>

  <h3>In Matrix Form</h3>
  <p>
    For a full layer operating on all rank-$k$ cells simultaneously, the update takes an elegant matrix form. Here's the simplified version for a rank-$k$ cochain $\mathbf{H}^{(k)}$:
  </p>

  <div class="math-block">
    <div class="math-label">Matrix form of one message-passing channel</div>
    $$\mathbf{H}^{(k, \ell+1)} = \sigma\!\left(\mathbf{A}_{k,\downarrow}\, \mathbf{H}^{(k,\ell)}\, \mathbf{W}_{\downarrow}^{(\ell)} + \mathbf{A}_{k,\uparrow}\, \mathbf{H}^{(k,\ell)}\, \mathbf{W}_{\uparrow}^{(\ell)} + \mathbf{B}_{k,k+1}\, \mathbf{H}^{(k+1,\ell)}\, \mathbf{W}_{\text{inc}}^{(\ell)} + \mathbf{H}^{(k,\ell)}\, \mathbf{W}_{\text{self}}^{(\ell)}\right)$$
  </div>

  <p>
    This should look familiar ‚Äî it's a direct generalization of the GCN update $\mathbf{H}^{(\ell+1)} = \sigma(\hat{\mathbf{A}}\mathbf{H}^{(\ell)}\mathbf{W}^{(\ell)})$, but now with <em>multiple adjacency matrices</em> operating across multiple ranks.
  </p>

  <div class="insight key">
    <p><strong>The key structural insight:</strong> In a standard GNN, information can only flow along edges (rank 1). In HOMP, information flows <em>up</em> (from boundaries to volumes), <em>down</em> (from volumes to boundaries), and <em>laterally</em> (between same-rank cells that share higher or lower cells). This enables the network to capture multi-scale, multi-resolution physics natively.</p>
  </div>
</section>

<hr class="divider">

<!-- ============================================================ -->
<!-- SECTION 9 -->
<!-- ============================================================ -->
<section id="sec9">
  <h2><span class="sec-num">09</span>Hodge Theory &amp; the Laplacian</h2>

  <p>
    If you know the graph Laplacian $\mathbf{L} = \mathbf{D} - \mathbf{A}$ (or its normalized variants), you know that it governs diffusion on graphs and that its eigenvectors provide a spectral basis for graph signals. The <strong>Hodge Laplacian</strong> generalizes this to all ranks.
  </p>

  <div class="def-box blue">
    <div class="def-label">Definition ‚Äî Hodge Laplacian</div>
    <p>For rank-$k$ cells in a simplicial or cell complex, the <strong>$k$-th Hodge Laplacian</strong> is:</p>
    $$\mathbf{L}_k = \underbrace{\mathbf{B}_{k-1,k}^\top \mathbf{B}_{k-1,k}}_{\text{lower Laplacian } \mathbf{L}_k^{\text{down}}} + \underbrace{\mathbf{B}_{k,k+1} \mathbf{B}_{k,k+1}^\top}_{\text{upper Laplacian } \mathbf{L}_k^{\text{up}}}$$
    <p>with the convention $\mathbf{B}_{-1,0} = 0$ and $\mathbf{B}_{K,K+1} = 0$. For $k=0$, this recovers the graph Laplacian: $\mathbf{L}_0 = \mathbf{B}_{0,1}\mathbf{B}_{0,1}^\top$.</p>
  </div>

  <div class="figure">
    <svg viewBox="0 0 700 220" width="700" height="220">
      <!-- Chain of Laplacians -->
      <text x="350" y="22" font-family="Source Sans 3" font-size="13" font-weight="700" fill="#2a2520" text-anchor="middle">The Hodge Laplacian Hierarchy</text>

      <!-- L0 -->
      <rect x="30" y="70" width="100" height="55" rx="8" fill="#e8a88a" fill-opacity="0.3" stroke="#b44a2f" stroke-width="1.5"/>
      <text x="80" y="95" font-family="Source Sans 3" font-size="13" font-weight="700" fill="#b44a2f" text-anchor="middle">L‚ÇÄ</text>
      <text x="80" y="115" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">on vertices</text>

      <!-- B01 arrow -->
      <line x1="130" y1="97" x2="180" y2="97" stroke="#6b6560" stroke-width="1.5" marker-end="url(#arrow-gray)"/>
      <text x="155" y="88" font-family="Source Sans 3" font-size="9" fill="#6b6560" text-anchor="middle">B‚ÇÄ‚ÇÅ</text>

      <!-- L1 -->
      <rect x="180" y="70" width="100" height="55" rx="8" fill="#8ec5b6" fill-opacity="0.3" stroke="#2a6b5a" stroke-width="1.5"/>
      <text x="230" y="95" font-family="Source Sans 3" font-size="13" font-weight="700" fill="#2a6b5a" text-anchor="middle">L‚ÇÅ</text>
      <text x="230" y="115" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">on edges</text>

      <!-- B12 arrow -->
      <line x1="280" y1="97" x2="330" y2="97" stroke="#6b6560" stroke-width="1.5" marker-end="url(#arrow-gray)"/>
      <text x="305" y="88" font-family="Source Sans 3" font-size="9" fill="#6b6560" text-anchor="middle">B‚ÇÅ‚ÇÇ</text>

      <!-- L2 -->
      <rect x="330" y="70" width="100" height="55" rx="8" fill="#a8c0e0" fill-opacity="0.3" stroke="#3a5a8c" stroke-width="1.5"/>
      <text x="380" y="95" font-family="Source Sans 3" font-size="13" font-weight="700" fill="#3a5a8c" text-anchor="middle">L‚ÇÇ</text>
      <text x="380" y="115" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">on faces</text>

      <!-- B23 arrow -->
      <line x1="430" y1="97" x2="480" y2="97" stroke="#6b6560" stroke-width="1.5" marker-end="url(#arrow-gray)"/>
      <text x="455" y="88" font-family="Source Sans 3" font-size="9" fill="#6b6560" text-anchor="middle">B‚ÇÇ‚ÇÉ</text>

      <!-- L3 -->
      <rect x="480" y="70" width="100" height="55" rx="8" fill="#c8a8d0" fill-opacity="0.3" stroke="#8b5a8c" stroke-width="1.5"/>
      <text x="530" y="95" font-family="Source Sans 3" font-size="13" font-weight="700" fill="#8b5a8c" text-anchor="middle">L‚ÇÉ</text>
      <text x="530" y="115" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">on volumes</text>

      <text x="60" y="45" font-family="Source Sans 3" font-size="10" fill="#b44a2f" text-anchor="middle">rank 0</text>
      <text x="210" y="45" font-family="Source Sans 3" font-size="10" fill="#2a6b5a" text-anchor="middle">rank 1</text>
      <text x="360" y="45" font-family="Source Sans 3" font-size="10" fill="#3a5a8c" text-anchor="middle">rank 2</text>
      <text x="510" y="45" font-family="Source Sans 3" font-size="10" fill="#8b5a8c" text-anchor="middle">rank 3</text>

      <!-- Formula below -->
      <rect x="50" y="155" width="600" height="50" rx="6" fill="#f8f4ee" stroke="#d5d0c8"/>
      <text x="350" y="178" font-family="JetBrains Mono" font-size="11" fill="#2a2520" text-anchor="middle">L_k = B_{k-1,k}·µÄ B_{k-1,k}  +  B_{k,k+1} B_{k,k+1}·µÄ</text>
      <text x="350" y="196" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">       ‚îî‚îÄ lower part ‚îÄ‚îò       ‚îî‚îÄ upper part ‚îÄ‚îò</text>

      <defs>
        <marker id="arrow-gray" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
          <path d="M 0 0 L 10 5 L 0 10 z" fill="#6b6560"/>
        </marker>
      </defs>
    </svg>
    <div class="caption"><strong>Figure 9.1.</strong> The hierarchy of Hodge Laplacians, connected by incidence (boundary) matrices $B_{k,k+1}$. Each $L_k$ has a "lower" part (from boundaries below) and an "upper" part (from cofaces above). The graph Laplacian $L_0$ is the first in the sequence.</div>
  </div>

  <div class="insight physics">
    <p><strong>Physics connection ‚Äî Hodge decomposition:</strong> The kernel of $L_k$ (harmonic cochains) corresponds to topological features: $\dim \ker L_k = \beta_k$, the $k$-th Betti number. For $k=0$, $\beta_0$ counts connected components. For $k=1$, $\beta_1$ counts independent loops. This is the discrete Hodge theorem ‚Äî the discrete analogue of the decomposition of differential forms into exact, coexact, and harmonic components. Every $k$-cochain $\omega$ admits:
    $$\omega = \underbrace{d_{k-1} \alpha}_{\text{exact}} + \underbrace{d_k^* \beta}_{\text{coexact}} + \underbrace{\gamma}_{\text{harmonic}}$$
    where $d_k$ is the coboundary operator ($B_{k,k+1}^\top$ in matrix form) and $d_k^*$ is its adjoint.</p>
  </div>

  <h3>Why Hodge Matters for Neural Networks</h3>
  <p>
    The Hodge Laplacian provides a <strong>spectrally meaningful diffusion operator for each rank</strong>. Just as spectral GNNs use eigenvectors of $L_0$ to define graph convolutions (via the graph Fourier transform), spectral topological networks can use eigenvectors of $L_k$ to define convolutions on $k$-cochains. The Hodge decomposition ensures these convolutions respect the topological structure of the complex.
  </p>
</section>

<hr class="divider">

<!-- ============================================================ -->
<!-- SECTION 10 -->
<!-- ============================================================ -->
<section id="sec10">
  <h2><span class="sec-num">10</span>The Architecture Zoo</h2>

  <p>
    The Hajij et al. paper surveys and unifies a large number of architectures that had been proposed independently. Here is a map of the landscape:
  </p>

  <div class="figure">
    <svg viewBox="0 0 700 440" width="700" height="440">
      <!-- Background regions -->
      <!-- Graph region -->
      <rect x="20" y="30" width="200" height="170" rx="10" fill="#e8a88a" fill-opacity="0.1" stroke="#b44a2f" stroke-width="1" stroke-dasharray="5,4"/>
      <text x="120" y="52" font-family="Source Sans 3" font-size="11" font-weight="700" fill="#b44a2f" text-anchor="middle">GRAPH DOMAIN</text>

      <!-- Simplicial region -->
      <rect x="250" y="30" width="200" height="170" rx="10" fill="#8ec5b6" fill-opacity="0.1" stroke="#2a6b5a" stroke-width="1" stroke-dasharray="5,4"/>
      <text x="350" y="52" font-family="Source Sans 3" font-size="11" font-weight="700" fill="#2a6b5a" text-anchor="middle">SIMPLICIAL DOMAIN</text>

      <!-- Cell region -->
      <rect x="480" y="30" width="200" height="170" rx="10" fill="#a8c0e0" fill-opacity="0.1" stroke="#3a5a8c" stroke-width="1" stroke-dasharray="5,4"/>
      <text x="580" y="52" font-family="Source Sans 3" font-size="11" font-weight="700" fill="#3a5a8c" text-anchor="middle">CELL DOMAIN</text>

      <!-- CC region (spanning bottom) -->
      <rect x="20" y="230" width="660" height="170" rx="10" fill="#c8a8d0" fill-opacity="0.1" stroke="#8b5a8c" stroke-width="1" stroke-dasharray="5,4"/>
      <text x="350" y="252" font-family="Source Sans 3" font-size="11" font-weight="700" fill="#8b5a8c" text-anchor="middle">COMBINATORIAL COMPLEX DOMAIN (unifies all above)</text>

      <!-- Architectures as cards -->
      <!-- GCN -->
      <rect x="40" y="70" width="80" height="35" rx="5" fill="white" stroke="#b44a2f" stroke-width="1.5"/>
      <text x="80" y="92" font-family="JetBrains Mono" font-size="10" fill="#b44a2f" text-anchor="middle" font-weight="500">GCN</text>
      <!-- GAT -->
      <rect x="40" y="115" width="80" height="35" rx="5" fill="white" stroke="#b44a2f" stroke-width="1.5"/>
      <text x="80" y="137" font-family="JetBrains Mono" font-size="10" fill="#b44a2f" text-anchor="middle" font-weight="500">GAT</text>
      <!-- GIN -->
      <rect x="130" y="70" width="80" height="35" rx="5" fill="white" stroke="#b44a2f" stroke-width="1.5"/>
      <text x="170" y="92" font-family="JetBrains Mono" font-size="10" fill="#b44a2f" text-anchor="middle" font-weight="500">GraphSAGE</text>

      <!-- SNN -->
      <rect x="265" y="70" width="80" height="35" rx="5" fill="white" stroke="#2a6b5a" stroke-width="1.5"/>
      <text x="305" y="92" font-family="JetBrains Mono" font-size="10" fill="#2a6b5a" text-anchor="middle" font-weight="500">SNN</text>
      <!-- SCA -->
      <rect x="355" y="70" width="80" height="35" rx="5" fill="white" stroke="#2a6b5a" stroke-width="1.5"/>
      <text x="395" y="92" font-family="JetBrains Mono" font-size="10" fill="#2a6b5a" text-anchor="middle" font-weight="500">SCA</text>
      <!-- MPSN -->
      <rect x="265" y="115" width="80" height="35" rx="5" fill="white" stroke="#2a6b5a" stroke-width="1.5"/>
      <text x="305" y="137" font-family="JetBrains Mono" font-size="10" fill="#2a6b5a" text-anchor="middle" font-weight="500">MPSN</text>
      <!-- SCN -->
      <rect x="355" y="115" width="80" height="35" rx="5" fill="white" stroke="#2a6b5a" stroke-width="1.5"/>
      <text x="395" y="137" font-family="JetBrains Mono" font-size="10" fill="#2a6b5a" text-anchor="middle" font-weight="500">SCN</text>

      <!-- CWN -->
      <rect x="500" y="70" width="80" height="35" rx="5" fill="white" stroke="#3a5a8c" stroke-width="1.5"/>
      <text x="540" y="92" font-family="JetBrains Mono" font-size="10" fill="#3a5a8c" text-anchor="middle" font-weight="500">CWN</text>
      <!-- CAN -->
      <rect x="590" y="70" width="80" height="35" rx="5" fill="white" stroke="#3a5a8c" stroke-width="1.5"/>
      <text x="630" y="92" font-family="JetBrains Mono" font-size="10" fill="#3a5a8c" text-anchor="middle" font-weight="500">CAN</text>

      <!-- CCXN -->
      <rect x="130" y="280" width="120" height="45" rx="6" fill="white" stroke="#8b5a8c" stroke-width="2"/>
      <text x="190" y="300" font-family="JetBrains Mono" font-size="11" fill="#8b5a8c" text-anchor="middle" font-weight="600">CC-XN</text>
      <text x="190" y="316" font-family="Source Sans 3" font-size="9" fill="#6b6560" text-anchor="middle">General CC</text>

      <!-- HMC -->
      <rect x="290" y="280" width="120" height="45" rx="6" fill="white" stroke="#8b5a8c" stroke-width="2"/>
      <text x="350" y="300" font-family="JetBrains Mono" font-size="11" fill="#8b5a8c" text-anchor="middle" font-weight="600">HOAN</text>
      <text x="350" y="316" font-family="Source Sans 3" font-size="9" fill="#6b6560" text-anchor="middle">Higher-Order Attn</text>

      <!-- Vinci -->
      <rect x="450" y="280" width="120" height="45" rx="6" fill="#b44a2f" fill-opacity="0.1" stroke="#b44a2f" stroke-width="2"/>
      <text x="510" y="300" font-family="JetBrains Mono" font-size="11" fill="#b44a2f" text-anchor="middle" font-weight="600">CTNN</text>
      <text x="510" y="316" font-family="Source Sans 3" font-size="9" fill="#b44a2f" text-anchor="middle">Copresheaf (Vinci)</text>

      <!-- Arrows showing subsumption -->
      <path d="M 80,160 Q 80,230 160,275" stroke="#b0a89e" stroke-width="1" fill="none" stroke-dasharray="3,3"/>
      <path d="M 305,155 Q 305,230 220,275" stroke="#b0a89e" stroke-width="1" fill="none" stroke-dasharray="3,3"/>
      <path d="M 540,110 Q 540,230 480,275" stroke="#b0a89e" stroke-width="1" fill="none" stroke-dasharray="3,3"/>

      <!-- Legend -->
      <text x="350" y="370" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" text-anchor="middle" font-weight="600">KEY ARCHITECTURE ACRONYMS</text>
      <text x="350" y="390" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">SNN = Simplicial Neural Network ¬∑ SCA = Simplicial Complex Attention ¬∑ MPSN = Message Passing Simplicial Network</text>
      <text x="350" y="408" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">SCN = Simplicial Convolutional Network ¬∑ CWN = CW Network ¬∑ CAN = Cell Attention Network</text>
      <text x="350" y="426" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">CC-XN = Combinatorial Complex Network ¬∑ HOAN = Higher-Order Attention ¬∑ CTNN = Copresheaf Topological NN</text>
    </svg>
    <div class="caption"><strong>Figure 10.1.</strong> The architecture landscape, organized by domain type. The combinatorial complex (bottom) subsumes all others. Dashed arrows indicate that graph, simplicial, and cell architectures are all special cases of the CC framework. The CTNN (Vinci AI) further generalizes by adding directional, learnable maps between cells (copresheaf structure).</div>
  </div>

  <h3>Selected Architecture Summaries</h3>

  <h4>Simplicial Neural Networks (SNN / SCN)</h4>
  <p>
    Operate on simplicial complexes using the Hodge Laplacians $L_k$ as the message-passing operator. The update for rank-$k$ features is a polynomial filter on $L_k$, analogous to ChebNet on graphs. These architectures respect the Hodge decomposition.
  </p>

  <h4>Message Passing Simplicial Networks (MPSN)</h4>
  <p>
    The most general simplicial architecture: uses separate message functions for boundary ($\mathcal{N}_\downarrow$), coboundary ($\mathcal{N}_\uparrow$), and adjacency ($\mathcal{N}_{\text{adj}}$) neighborhoods at each rank. A strict generalization of standard MPNN.
  </p>

  <h4>CW Networks (CWN)</h4>
  <p>
    Extend MPSN to cell complexes, allowing non-simplicial cells. The key addition: messages can now flow along boundaries of arbitrary polygon/polyhedron cells, not just triangles and tetrahedra.
  </p>

  <h4>The Hajij et al. Unification</h4>
  <p>
    The paper's central technical contribution is showing that all of these architectures ‚Äî and several more ‚Äî can be expressed as <strong>instances of a single tensor diagram</strong> on a CC. The tensor diagram specifies which neighborhood matrices are used, how messages are computed, and how they're aggregated. Different choices of these components recover different existing architectures.
  </p>
</section>

<hr class="divider">

<!-- ============================================================ -->
<!-- SECTION 11 -->
<!-- ============================================================ -->
<section id="sec11">
  <h2><span class="sec-num">11</span>From Topology to Thermal Physics</h2>

  <p>
    With the mathematical framework in place, we can now see <strong>why topological deep learning is a natural fit for thermal simulation</strong> ‚Äî the application that Vinci AI has commercialized.
  </p>

  <h3>A Chip Package as a Combinatorial Complex</h3>
  <p>
    Consider a 3D stacked IC package. Its structure maps naturally to a CC:
  </p>

  <div class="figure">
    <svg viewBox="0 0 700 280" width="700" height="280">
      <text x="350" y="22" font-family="Source Sans 3" font-size="13" font-weight="700" fill="#2a2520" text-anchor="middle">Chip Package ‚Üí Combinatorial Complex</text>

      <!-- Physical side -->
      <rect x="20" y="40" width="300" height="220" rx="8" fill="white" stroke="#d5d0c8"/>
      <text x="170" y="65" font-family="Source Sans 3" font-size="11" font-weight="700" fill="#2a2520" text-anchor="middle">Physical Structure</text>

      <!-- Stack of layers -->
      <rect x="60" y="80" width="220" height="25" rx="3" fill="#c8a8d0" fill-opacity="0.3" stroke="#8b5a8c"/>
      <text x="170" y="97" font-family="Source Sans 3" font-size="10" fill="#8b5a8c" text-anchor="middle">TIM (volume)</text>

      <rect x="60" y="110" width="220" height="25" rx="3" fill="#a8c0e0" fill-opacity="0.3" stroke="#3a5a8c"/>
      <text x="170" y="127" font-family="Source Sans 3" font-size="10" fill="#3a5a8c" text-anchor="middle">Carrier Si (volume)</text>

      <rect x="60" y="140" width="220" height="25" rx="3" fill="#8ec5b6" fill-opacity="0.2" stroke="#2a6b5a"/>
      <text x="170" y="157" font-family="Source Sans 3" font-size="10" fill="#2a6b5a" text-anchor="middle">BEOL (detailed geometry)</text>

      <rect x="60" y="170" width="220" height="25" rx="3" fill="#e8d8a8" fill-opacity="0.3" stroke="#8b7a3c"/>
      <text x="170" y="187" font-family="Source Sans 3" font-size="10" fill="#8b7a3c" text-anchor="middle">Hybrid Bonding (volume)</text>

      <rect x="60" y="200" width="220" height="25" rx="3" fill="#a8c0e0" fill-opacity="0.3" stroke="#3a5a8c"/>
      <text x="170" y="217" font-family="Source Sans 3" font-size="10" fill="#3a5a8c" text-anchor="middle">Si 2 (volume)</text>

      <!-- Interfaces marked -->
      <line x1="55" y1="108" x2="285" y2="108" stroke="#b44a2f" stroke-width="1.5" stroke-dasharray="3,2"/>
      <text x="295" y="112" font-family="Source Sans 3" font-size="9" fill="#b44a2f" text-anchor="start">interface</text>
      <line x1="55" y1="138" x2="285" y2="138" stroke="#b44a2f" stroke-width="1.5" stroke-dasharray="3,2"/>
      <line x1="55" y1="168" x2="285" y2="168" stroke="#b44a2f" stroke-width="1.5" stroke-dasharray="3,2"/>
      <line x1="55" y1="198" x2="285" y2="198" stroke="#b44a2f" stroke-width="1.5" stroke-dasharray="3,2"/>

      <!-- CC side -->
      <rect x="380" y="40" width="300" height="220" rx="8" fill="white" stroke="#d5d0c8"/>
      <text x="530" y="65" font-family="Source Sans 3" font-size="11" font-weight="700" fill="#2a2520" text-anchor="middle">CC Representation</text>

      <!-- Rank assignments -->
      <text x="400" y="95" font-family="Source Sans 3" font-size="11" fill="#b44a2f" font-weight="600">Rank 0 (vertices)</text>
      <text x="400" y="112" font-family="Source Sans 3" font-size="10" fill="#6b6560">Grid points, via nodes</text>

      <text x="400" y="142" font-family="Source Sans 3" font-size="11" fill="#2a6b5a" font-weight="600">Rank 1 (edges)</text>
      <text x="400" y="159" font-family="Source Sans 3" font-size="10" fill="#6b6560">Material interfaces, thermal paths</text>

      <text x="400" y="189" font-family="Source Sans 3" font-size="11" fill="#3a5a8c" font-weight="600">Rank 2 (faces / tiles)</text>
      <text x="400" y="206" font-family="Source Sans 3" font-size="10" fill="#6b6560">Homogenization regions, surfaces</text>

      <text x="400" y="236" font-family="Source Sans 3" font-size="11" fill="#8b5a8c" font-weight="600">Rank 3 (volumes)</text>
      <text x="400" y="253" font-family="Source Sans 3" font-size="10" fill="#6b6560">Material layers, package volumes</text>

      <!-- Arrow -->
      <text x="345" y="155" font-family="Source Sans 3" font-size="22" fill="#b0a89e" text-anchor="middle">‚Üí</text>
    </svg>
    <div class="caption"><strong>Figure 11.1.</strong> A chip package maps to a CC: grid nodes are rank-0 cells, material interfaces are rank-1, homogenization tiles are rank-2, and volumetric layers are rank-3. Heat source distributions, boundary conditions, and material properties become features (cochains) at the appropriate rank.</div>
  </div>

  <h3>Why Anisotropic Message Passing Matters</h3>
  <p>
    In the EPTC 2025 paper, the BEOL layer exhibits extreme anisotropy: $k_y^{\text{eff}} / k_z^{\text{eff}} \approx 23\times$. Heat flows much more easily in-plane than through-plane. A standard GNN treats all message-passing directions identically. The <strong>copresheaf structure</strong> (Hajij et al., NeurIPS 2025, arXiv:2505.21251) adds direction-dependent, learnable linear maps between cells ‚Äî the network can <em>learn</em> that vertical and horizontal information flow have fundamentally different character, without this being hard-coded.
  </p>

  <div class="insight key">
    <p><strong>The CTNN advantage for physics:</strong> In a copresheaf topological neural network, the "restriction maps" between cells are learnable linear operators, not fixed aggregation rules. For thermal simulation, this means the network can learn that information flowing from a BEOL tile to its neighbor <em>through a shared edge</em> should be weighted differently than information flowing <em>up through a layer interface</em> ‚Äî because these represent physically different thermal transport pathways.</p>
  </div>

  <h3>From Message Passing to PDE Solving</h3>
  <p>
    The steady-state heat equation $\nabla \cdot (k \nabla T) = 0$ is, on a discrete mesh, equivalent to a system $\mathbf{L}\mathbf{T} = \mathbf{f}$ where $\mathbf{L}$ is a Laplacian operator weighted by thermal conductivities. The Hodge Laplacian $L_k$ on a CC is a direct generalization. The connection is not merely analogical ‚Äî <strong>message passing on a CC with Hodge-Laplacian-weighted adjacency is literally performing iterative relaxation of the discrete heat equation</strong>.
  </p>

  <div class="math-block">
    <div class="math-label">The connection: Message Passing ‚Üî PDE Iteration</div>
    $$\underbrace{\mathbf{T}^{(n+1)} = \mathbf{T}^{(n)} - \alpha \mathbf{L}_k \mathbf{T}^{(n)}}_{\text{Jacobi iteration on heat equation}} \quad \longleftrightarrow \quad \underbrace{\mathbf{H}^{(\ell+1)} = \sigma\!\left(\hat{\mathbf{L}}_k \mathbf{H}^{(\ell)} \mathbf{W}^{(\ell)}\right)}_{\text{Topological neural network layer}}$$
  </div>

  <p>
    The neural network version replaces the fixed step size $\alpha$ with <em>learned</em> weights $\mathbf{W}$, the linear update with a nonlinear activation $\sigma$, and the single Laplacian with a <em>combination</em> of adjacency matrices from multiple ranks and neighborhoods. This is why a well-trained topological neural network can solve PDEs much faster than traditional iterative solvers ‚Äî it learns an optimized, nonlinear, multi-scale iteration scheme.
  </p>
</section>

<hr class="divider">

<!-- ============================================================ -->
<!-- SECTION 12 -->
<!-- ============================================================ -->
<section id="sec12">
  <h2><span class="sec-num">12</span>Roadmap to the Full Paper</h2>

  <p>
    You now have the conceptual and mathematical vocabulary needed to read Hajij et al., "Topological Deep Learning: Going Beyond Graph Data" (arXiv:2206.00606). Here is a guide to the paper's structure, mapped to what you've learned:
  </p>

  <table class="comp-table">
    <thead>
      <tr><th>Paper Section</th><th>What You'll Find</th><th>Background from This Guide</th></tr>
    </thead>
    <tbody>
      <tr>
        <td>¬ß1‚Äì2: Introduction</td>
        <td>Motivation, related work</td>
        <td>Section 1 (Why Go Beyond Graphs)</td>
      </tr>
      <tr>
        <td>¬ß3: Topological Domains</td>
        <td>Formal definitions of simplicial, cell, and combinatorial complexes</td>
        <td>Sections 3‚Äì5</td>
      </tr>
      <tr>
        <td>¬ß4: Topological Signals</td>
        <td>Cochains, cochain spaces</td>
        <td>Section 6</td>
      </tr>
      <tr>
        <td>¬ß5: Higher-Order Neighborhoods</td>
        <td>Adjacency and incidence matrices, neighborhood functions</td>
        <td>Section 7</td>
      </tr>
      <tr>
        <td>¬ß6: Tensor Diagrams</td>
        <td>Unified computational framework ‚Äî <em>new material</em>, build on Section 8</td>
        <td>Section 8 (HOMP)</td>
      </tr>
      <tr>
        <td>¬ß7: Message Passing</td>
        <td>General HOMP framework, push-forward and merge operators</td>
        <td>Section 8</td>
      </tr>
      <tr>
        <td>¬ß8: Topological Pooling</td>
        <td>Coarsening strategies ‚Äî <em>new material</em></td>
        <td>Analogous to graph pooling</td>
      </tr>
      <tr>
        <td>¬ß9: Architectures</td>
        <td>Detailed review of SNN, MPSN, CWN, etc.</td>
        <td>Section 10</td>
      </tr>
      <tr>
        <td>Appendices</td>
        <td>Homology, Betti numbers, Hodge theory</td>
        <td>Section 9</td>
      </tr>
    </tbody>
  </table>

  <h3>Key Papers for Further Study</h3>

  <ol class="steps">
    <li>
      <strong>The foundational paper</strong> ‚Äî Hajij et al., "Topological Deep Learning: Going Beyond Graph Data." arXiv:2206.00606 (2022). <em>Read this next.</em>
    </li>
    <li>
      <strong>The Vinci architecture</strong> ‚Äî Hajij, Bastian, Osentoski, Kabaria et al., "Copresheaf Topological Neural Networks." arXiv:2505.21251 (2025), NeurIPS 2025. <em>Adds the directional/learnable message-passing maps (copresheaf structure).</em>
    </li>
    <li>
      <strong>Open-source implementation</strong> ‚Äî TopoModelX (github.com/pyt-team/TopoModelX). <em>PyTorch implementations of the architectures discussed in the paper.</em>
    </li>
    <li>
      <strong>Benchmarking</strong> ‚Äî Hajij et al., "A Framework for Benchmarking Topological Deep Learning." arXiv:2406.06642 (2024). <em>Systematic comparison of TDL architectures on standardized tasks.</em>
    </li>
    <li>
      <strong>The thermal application</strong> ‚Äî Kabaria et al., "Thermal Sensitivity Analysis of 3D IC Face-to-Back Stacking Using Foundation Models for Physics." IEEE EPTC 2025. <em>Shows TDL applied to real semiconductor thermal simulation.</em>
    </li>
  </ol>

  <div class="insight">
    <p><strong>The big picture:</strong> Topological deep learning isn't just a new flavor of GNN. It's a <em>category-theoretic</em> framework that treats deep learning layers as functors on topological domains. The combinatorial complex provides the most general domain; cochains provide the signals; higher-order message passing provides the computation; and the Hodge Laplacian provides spectral grounding. The Vinci/CTNN extension adds morphisms between feature spaces (the copresheaf), turning each message-passing step into a <em>structure-preserving map</em> rather than a flat aggregation. This is what enables it to capture the anisotropic, heterogeneous physics of semiconductor thermal simulation.</p>
  </div>
</section>

</main>

<!-- ====== FOOTER ====== -->
<footer>
  <p>Prepared as self-study course material ¬∑ February 2026</p>
  <p style="margin-top:0.5rem;">
    Primary reference: Hajij et al., <a href="https://arxiv.org/abs/2206.00606" target="_blank">arXiv:2206.00606</a> ¬∑ 
    CTNN: <a href="https://arxiv.org/abs/2505.21251" target="_blank">arXiv:2505.21251</a> ¬∑
    TopoX: <a href="https://github.com/pyt-team/TopoModelX" target="_blank">GitHub</a>
  </p>
</footer>

</body>
</html>
