<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Signals, Neighborhoods &amp; <strong>Message Passing</strong> ‚Äî Topological Deep Learning Course</title>
<script>window.MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],['\\[','\\]']]},svg:{fontCache:'global'}};</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-svg-full.min.js"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Crimson+Pro:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500&family=JetBrains+Mono:wght@400;500&family=Source+Sans+3:ital,wght@0,300;0,400;0,600;0,700;1,400&display=swap');

:root {
  --bg: #faf8f5; --bg-alt: #f0ede8; --text: #2a2520; --text-muted: #6b6560;
  --accent: #b44a2f; --accent2: #2a6b5a; --accent3: #3a5a8c; --accent4: #8b5a8c;
  --border: #d5d0c8; --card: #ffffff;
  --shadow: 0 2px 12px rgba(42,37,32,0.08); --shadow-lg: 0 8px 32px rgba(42,37,32,0.12);
}
* { margin: 0; padding: 0; box-sizing: border-box; }
html { scroll-behavior: smooth; font-size: 17px; }
body { font-family: 'Crimson Pro', Georgia, serif; background: var(--bg); color: var(--text); line-height: 1.72; -webkit-font-smoothing: antialiased; }
.container { max-width: 820px; margin: 0 auto; padding: 0 2rem; }

/* Header */
header { background: linear-gradient(175deg, #1a1512 0%, #2a2018 40%, #3a2a1f 100%); color: #f0ece6; padding: 3.5rem 2rem 2.5rem; position: relative; overflow: hidden; }
header::before { content: ''; position: absolute; inset: 0; background: radial-gradient(ellipse 600px 400px at 20% 80%, rgba(180,74,47,0.15), transparent), radial-gradient(ellipse 500px 300px at 80% 20%, rgba(42,107,90,0.12), transparent); }
header .container { position: relative; z-index: 1; }
header .breadcrumb { font-family: 'Source Sans 3', sans-serif; font-size: 0.82rem; color: #8a8078; margin-bottom: 0.8rem; }
header .breadcrumb a { color: #c8a888; text-decoration: none; }
header .breadcrumb a:hover { color: #e8a88a; }
header .ch-num { font-family: 'JetBrains Mono', monospace; font-size: 0.85rem; color: var(--accent); display: block; margin-bottom: 0.3rem; font-weight: 500; letter-spacing: 0.05em; }
header h1 { font-size: 2.2rem; font-weight: 300; letter-spacing: -0.02em; line-height: 1.2; margin-bottom: 0.6rem; }
header h1 strong { font-weight: 700; color: #e8a88a; }
header .subtitle { font-family: 'Source Sans 3', sans-serif; font-size: 0.95rem; color: #b0a89e; max-width: 560px; line-height: 1.6; }

/* Navigation */
nav.ch-nav { background: var(--card); border-bottom: 1px solid var(--border); padding: 0.8rem 0; position: sticky; top: 0; z-index: 10; box-shadow: 0 2px 8px rgba(0,0,0,0.04); }
nav.ch-nav .container { display: flex; justify-content: space-between; align-items: center; }
nav.ch-nav a { font-family: 'Source Sans 3', sans-serif; font-size: 0.85rem; color: var(--accent); text-decoration: none; display: flex; align-items: center; gap: 0.3rem; }
nav.ch-nav a:hover { color: #d05a3f; }
nav.ch-nav .disabled { color: var(--border); pointer-events: none; }
nav.ch-nav .ch-title { font-family: 'Source Sans 3', sans-serif; font-size: 0.78rem; color: var(--text-muted); font-weight: 600; text-transform: uppercase; letter-spacing: 0.08em; }

/* Sections */
section { margin-bottom: 3.5rem; padding-top: 1rem; }
section h2 { font-size: 1.9rem; font-weight: 600; margin-bottom: 0.3rem; color: var(--text); letter-spacing: -0.01em; }
section h2 .sec-num { font-family: 'JetBrains Mono', monospace; font-size: 0.85rem; color: var(--accent); display: block; margin-bottom: 0.3rem; font-weight: 500; }
section h3 { font-size: 1.3rem; font-weight: 600; margin-top: 2rem; margin-bottom: 0.5rem; }
section h4 { font-family: 'Source Sans 3', sans-serif; font-size: 1rem; font-weight: 700; margin-top: 1.5rem; margin-bottom: 0.4rem; color: var(--accent2); text-transform: uppercase; letter-spacing: 0.04em; }
p { margin-bottom: 1rem; }
strong { font-weight: 600; }
em { font-style: italic; }

/* Definition boxes */
.def-box { background: var(--card); border: 1px solid var(--border); border-left: 4px solid var(--accent); border-radius: 0 8px 8px 0; padding: 1.5rem 1.8rem; margin: 1.5rem 0; box-shadow: var(--shadow); }
.def-box.green { border-left-color: var(--accent2); }
.def-box.blue { border-left-color: var(--accent3); }
.def-box.purple { border-left-color: var(--accent4); }
.def-box .def-label { font-family: 'Source Sans 3', sans-serif; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 0.5rem; }
.def-box .def-label { color: var(--accent); }
.def-box.green .def-label { color: var(--accent2); }
.def-box.blue .def-label { color: var(--accent3); }
.def-box.purple .def-label { color: var(--accent4); }

/* Insight boxes */
.insight { background: linear-gradient(135deg, #f8f4ee, #f5f0e8); border-radius: 8px; padding: 1.3rem 1.6rem; margin: 1.5rem 0; position: relative; }
.insight::before { content: 'üí°'; position: absolute; top: -0.6rem; left: 1rem; font-size: 1.1rem; background: var(--bg); padding: 0 0.3rem; }
.insight.physics::before { content: '‚öõÔ∏è'; }
.insight.warning::before { content: '‚ö†Ô∏è'; }
.insight.key::before { content: 'üîë'; }
.insight p:last-child { margin-bottom: 0; }
.insight strong { color: var(--accent); }

/* Figures */
.figure { background: var(--card); border: 1px solid var(--border); border-radius: 10px; padding: 1.5rem; margin: 2rem 0; text-align: center; box-shadow: var(--shadow); }
.figure svg { max-width: 100%; height: auto; }
.figure .caption { font-family: 'Source Sans 3', sans-serif; font-size: 0.85rem; color: var(--text-muted); margin-top: 1rem; text-align: left; line-height: 1.5; }
.figure .caption strong { color: var(--text); font-weight: 600; }

/* Math */
.math-block { background: var(--card); border: 1px solid var(--border); border-radius: 8px; padding: 1.2rem 1.5rem; margin: 1.5rem 0; overflow-x: auto; box-shadow: var(--shadow); }
.math-block .math-label { font-family: 'Source Sans 3', sans-serif; font-size: 0.75rem; font-weight: 600; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 0.5rem; }

/* Tables */
.comp-table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; font-family: 'Source Sans 3', sans-serif; font-size: 0.9rem; }
.comp-table th { background: var(--bg-alt); font-weight: 700; text-align: left; padding: 0.7rem 1rem; border-bottom: 2px solid var(--border); font-size: 0.8rem; text-transform: uppercase; letter-spacing: 0.05em; color: var(--text-muted); }
.comp-table td { padding: 0.6rem 1rem; border-bottom: 1px solid var(--border); vertical-align: top; }

/* Steps */
.steps { margin: 1.5rem 0; padding-left: 0; list-style: none; counter-reset: step; }
.steps li { counter-increment: step; padding: 0.8rem 0 0.8rem 3rem; position: relative; border-left: 2px solid var(--border); margin-left: 1rem; }
.steps li:last-child { border-left-color: transparent; }
.steps li::before { content: counter(step); position: absolute; left: -0.85rem; top: 0.7rem; width: 1.7rem; height: 1.7rem; background: var(--accent); color: white; border-radius: 50%; font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; font-weight: 500; display: flex; align-items: center; justify-content: center; }

code { font-family: 'JetBrains Mono', monospace; font-size: 0.85em; background: var(--bg-alt); padding: 0.15em 0.4em; border-radius: 4px; }
.divider { border: none; height: 1px; background: linear-gradient(90deg, transparent, var(--border), transparent); margin: 3rem 0; }

/* Footer nav */
.footer-nav { display: flex; justify-content: space-between; align-items: stretch; gap: 1rem; margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--border); }
.footer-nav a { font-family: 'Source Sans 3', sans-serif; text-decoration: none; color: var(--text); padding: 1rem 1.2rem; border: 1px solid var(--border); border-radius: 8px; flex: 1; transition: border-color 0.2s, box-shadow 0.2s; }
.footer-nav a:hover { border-color: var(--accent); box-shadow: var(--shadow); }
.footer-nav .dir { font-size: 0.72rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.1em; color: var(--accent); display: block; margin-bottom: 0.2rem; }
.footer-nav .title { font-size: 0.9rem; font-weight: 600; }
.footer-nav .next { text-align: right; }
.footer-nav .spacer { flex: 1; }

footer { background: #1a1512; color: #8a8078; padding: 2.5rem 2rem; margin-top: 3rem; font-family: 'Source Sans 3', sans-serif; font-size: 0.85rem; text-align: center; }
footer a { color: #c8a888; text-decoration: none; }

/* SVG tokens */
.node-v { fill: #e8a88a; stroke: #b44a2f; }
.node-e { fill: #8ec5b6; stroke: #2a6b5a; }
.node-f { fill: #a8c0e0; stroke: #3a5a8c; }
.edge-line { stroke: #6b6560; stroke-width: 1.5; }
.label-text { font-family: 'Source Sans 3', sans-serif; font-size: 11px; fill: #2a2520; text-anchor: middle; }
.label-sm { font-family: 'Source Sans 3', sans-serif; font-size: 10px; fill: #6b6560; text-anchor: middle; }

@media (max-width: 700px) { html { font-size: 15px; } header h1 { font-size: 1.8rem; } .container { padding: 0 1.2rem; } .footer-nav { flex-direction: column; } }
</style>
</head>
<body>
<header>
  <div class="container">
    <div class="breadcrumb"><a href="index.html">Home</a> / <a href="tdl-index.html">Topological Deep Learning</a> / Chapter 6</div>
    <span class="ch-num">Chapter 06</span>
    <h1>Signals, Neighborhoods &amp; <strong>Message Passing</strong></h1>
    <p class="subtitle">Cochains as feature spaces, the three types of adjacency, and the general higher-order message passing framework.</p>
  </div>
</header>
<nav class="ch-nav"><div class="container"><a href="tdl-05-complexes.html">‚Üê Simplicial, Cell & Combinatorial Complexes</a><span class="ch-title">Chapter 6</span><a href="tdl-07-architectures.html">Hodge Theory & the Architecture Zoo ‚Üí</a></div></nav>
<main class="container" style="padding-top:2rem;padding-bottom:2rem;">
<section id="sec6">
  <h2><span class="sec-num">06</span>Signals, Cochains &amp; Feature Spaces</h2>

  <p>
    With the domain structure (the complex) established, we now need to put <strong>data on it</strong>. In physics, you assign fields to points (scalar fields), curves (line integrals), surfaces (flux), and volumes (densities). The discrete version of this is a <strong>cochain</strong>.
  </p>

  <div class="def-box green">
    <div class="def-label">Definition ‚Äî $k$-Cochain</div>
    <p>Let $\mathcal{X}_k$ denote the set of all rank-$k$ cells in a CC. A <strong>$k$-cochain</strong> is a function $\mathbf{h}: \mathcal{X}_k \to \mathbb{R}^{d_k}$ assigning a feature vector to each rank-$k$ cell. The space of all $k$-cochains is $C^k(\mathcal{X}; \mathbb{R}^{d_k}) \cong \mathbb{R}^{|\mathcal{X}_k| \times d_k}$.</p>
  </div>

  <div class="figure">
    <svg viewBox="0 0 650 250" width="650" height="250">
      <!-- A small complex with features labeled -->
      <text x="170" y="22" font-family="Source Sans 3" font-size="13" font-weight="700" fill="#2a2520" text-anchor="middle">Features on a Complex</text>

      <!-- 2-cell (filled region) -->
      <polygon points="80,100 200,70 230,160 120,180" fill="#a8c0e0" fill-opacity="0.2" stroke="#3a5a8c" stroke-width="1.5"/>

      <!-- Edges -->
      <line x1="80" y1="100" x2="200" y2="70" stroke="#2a6b5a" stroke-width="2.5"/>
      <line x1="200" y1="70" x2="230" y2="160" stroke="#2a6b5a" stroke-width="2.5"/>
      <line x1="230" y1="160" x2="120" y2="180" stroke="#2a6b5a" stroke-width="2.5"/>
      <line x1="120" y1="180" x2="80" y2="100" stroke="#2a6b5a" stroke-width="2.5"/>
      <line x1="80" y1="100" x2="50" y2="190" stroke="#2a6b5a" stroke-width="2.5"/>

      <!-- Vertices -->
      <circle cx="80" cy="100" r="12" class="node-v" stroke-width="2"/>
      <circle cx="200" cy="70" r="12" class="node-v" stroke-width="2"/>
      <circle cx="230" cy="160" r="12" class="node-v" stroke-width="2"/>
      <circle cx="120" cy="180" r="12" class="node-v" stroke-width="2"/>
      <circle cx="50" cy="190" r="12" class="node-v" stroke-width="2"/>

      <!-- Feature annotations -->
      <!-- Vertex features -->
      <rect x="270" y="55" width="150" height="26" rx="4" fill="#e8a88a" fill-opacity="0.3" stroke="#b44a2f"/>
      <text x="345" y="73" font-family="Source Sans 3" font-size="11" fill="#b44a2f" text-anchor="middle" font-weight="600">0-cochain: h‚Å∞ ‚àà ‚Ñù‚ÅµÀ£·µà‚Å∞</text>
      <text x="345" y="95" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" text-anchor="middle">e.g., material type, temperature</text>

      <!-- Edge features -->
      <rect x="270" y="115" width="150" height="26" rx="4" fill="#8ec5b6" fill-opacity="0.3" stroke="#2a6b5a"/>
      <text x="345" y="133" font-family="Source Sans 3" font-size="11" fill="#2a6b5a" text-anchor="middle" font-weight="600">1-cochain: h¬π ‚àà ‚Ñù‚ÅµÀ£·µà¬π</text>
      <text x="345" y="155" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" text-anchor="middle">e.g., contact conductance, flux</text>

      <!-- Face features -->
      <rect x="270" y="175" width="150" height="26" rx="4" fill="#a8c0e0" fill-opacity="0.3" stroke="#3a5a8c"/>
      <text x="345" y="193" font-family="Source Sans 3" font-size="11" fill="#3a5a8c" text-anchor="middle" font-weight="600">2-cochain: h¬≤ ‚àà ‚Ñù¬πÀ£·µà¬≤</text>
      <text x="345" y="215" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" text-anchor="middle">e.g., eff. conductivity tensor</text>

      <!-- Arrows -->
      <line x1="95" y1="92" x2="268" y2="68" stroke="#b44a2f" stroke-width="0.8" stroke-dasharray="3,3"/>
      <line x1="150" y1="85" x2="268" y2="128" stroke="#2a6b5a" stroke-width="0.8" stroke-dasharray="3,3"/>
      <line x1="160" y1="130" x2="268" y2="188" stroke="#3a5a8c" stroke-width="0.8" stroke-dasharray="3,3"/>
    </svg>
    <div class="caption"><strong>Figure 6.1.</strong> A cochain assigns feature vectors to cells of each rank. Crucially, the feature dimension $d_k$ can differ by rank ‚Äî vertex features (material properties at a point) can have different dimensionality than edge features (interface properties) or face features (effective tensor properties).</div>
  </div>

  <div class="insight physics">
    <p><strong>Physics connection:</strong> This is exactly the discrete de Rham complex. In EM, 0-cochains correspond to scalar potentials at nodes, 1-cochains to line integrals of the vector potential along edges, 2-cochains to magnetic flux through faces, and 3-cochains to charge density in volumes. The TDL framework generalizes this by allowing <em>learned</em> feature vectors instead of single scalars.</p>
  </div>

  <h3>The Full State of a CC</h3>
  <p>
    The complete state of a CC with maximum rank $K$ is a tuple of cochains at each rank:
  </p>

  <div class="math-block">
    <div class="math-label">State of a Combinatorial Complex</div>
    $$\mathbf{H} = \left(\mathbf{H}^{(0)}, \, \mathbf{H}^{(1)}, \, \ldots, \, \mathbf{H}^{(K)}\right) \quad \text{where} \quad \mathbf{H}^{(k)} \in \mathbb{R}^{|\mathcal{X}_k| \times d_k}$$
  </div>

  <p>
    Each row of $\mathbf{H}^{(k)}$ is the feature vector of one rank-$k$ cell. A topological neural network layer takes this full tuple as input and produces an updated tuple as output ‚Äî it updates features <em>across all ranks simultaneously</em>.
  </p>
</section>

<hr class="divider">

<!-- ============================================================ -->
<!-- SECTION 7 -->
<!-- ============================================================ -->
<hr class="divider">
<section id="sec7">
  <h2><span class="sec-num">07</span>Neighborhood &amp; Adjacency</h2>

  <p>
    In a graph, the neighborhood of a node is simple: the set of nodes connected by an edge. In a CC, there are <strong>many possible notions of neighborhood</strong>, because cells can be related by sharing vertices, sharing boundaries, or being contained in one another. The Hajij et al. paper systematically catalogs these.
  </p>

  <h3>Three Types of Adjacency</h3>

  <div class="figure">
    <svg viewBox="0 0 700 350" width="700" height="350">
      <!-- Type 1: Co-adjacency (same rank, share a lower cell) -->
      <rect x="15" y="10" width="210" height="320" rx="8" fill="white" stroke="#d5d0c8"/>
      <text x="120" y="38" font-family="Source Sans 3" font-size="12" font-weight="700" fill="#b44a2f" text-anchor="middle">(Co-)Adjacency</text>
      <text x="120" y="56" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" text-anchor="middle">Same rank, share a boundary cell</text>

      <!-- Two triangles sharing an edge -->
      <polygon points="50,130 130,100 110,180" fill="#a8c0e0" fill-opacity="0.3" stroke="#3a5a8c" stroke-width="1.5"/>
      <polygon points="130,100 190,140 110,180" fill="#8ec5b6" fill-opacity="0.25" stroke="#2a6b5a" stroke-width="1.5"/>
      <!-- Shared edge highlighted -->
      <line x1="130" y1="100" x2="110" y2="180" stroke="#b44a2f" stroke-width="3"/>
      <circle cx="50" cy="130" r="6" class="node-v" stroke-width="1.5"/>
      <circle cx="130" cy="100" r="6" class="node-v" stroke-width="1.5"/>
      <circle cx="110" cy="180" r="6" class="node-v" stroke-width="1.5"/>
      <circle cx="190" cy="140" r="6" class="node-v" stroke-width="1.5"/>
      <text x="90" y="145" font-family="Source Sans 3" font-size="9" fill="#3a5a8c" font-weight="600">œÉ‚ÇÅ</text>
      <text x="150" y="145" font-family="Source Sans 3" font-size="9" fill="#2a6b5a" font-weight="600">œÉ‚ÇÇ</text>

      <!-- Arrows showing message -->
      <path d="M 85,152 C 100,170 130,170 148,152" stroke="#b44a2f" stroke-width="1.5" fill="none" marker-end="url(#arrow-red)"/>

      <text x="120" y="220" font-family="Source Sans 3" font-size="10.5" fill="#2a2520" text-anchor="middle">œÉ‚ÇÅ and œÉ‚ÇÇ are <tspan font-style="italic">adjacent</tspan></text>
      <text x="120" y="240" font-family="Source Sans 3" font-size="10.5" fill="#2a2520" text-anchor="middle">(both rank 2, share an edge)</text>
      <text x="120" y="275" font-family="JetBrains Mono" font-size="10" fill="#b44a2f" text-anchor="middle">A_{k,k} matrix</text>
      <text x="120" y="295" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">e.g., graph adjacency A</text>
      <text x="120" y="310" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">is A_{0,0} via shared edges</text>

      <!-- Type 2: Incidence (cross-rank: boundary/coboundary) -->
      <rect x="245" y="10" width="210" height="320" rx="8" fill="white" stroke="#d5d0c8"/>
      <text x="350" y="38" font-family="Source Sans 3" font-size="12" font-weight="700" fill="#2a6b5a" text-anchor="middle">Incidence</text>
      <text x="350" y="56" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" text-anchor="middle">Cross-rank: cell ‚äÇ higher cell</text>

      <!-- Triangle with an edge highlighted as boundary -->
      <polygon points="290,130 370,100 350,190" fill="#a8c0e0" fill-opacity="0.25" stroke="#3a5a8c" stroke-width="1.5"/>
      <line x1="290" y1="130" x2="370" y2="100" stroke="#2a6b5a" stroke-width="3"/>
      <circle cx="290" cy="130" r="6" class="node-v" stroke-width="1.5"/>
      <circle cx="370" cy="100" r="6" class="node-v" stroke-width="1.5"/>
      <circle cx="350" cy="190" r="6" class="node-v" stroke-width="1.5"/>
      <text x="330" y="152" font-family="Source Sans 3" font-size="9" fill="#3a5a8c" font-weight="600">œÉ (rank 2)</text>
      <text x="340" y="105" font-family="Source Sans 3" font-size="9" fill="#2a6b5a" font-weight="600">œÑ (rank 1)</text>

      <!-- Arrow: edge ‚Üí face -->
      <path d="M 342,110 L 335,135" stroke="#2a6b5a" stroke-width="2" fill="none" marker-end="url(#arrow-green)"/>
      <text x="358" y="128" font-family="Source Sans 3" font-size="9" fill="#2a6b5a">œÑ ‚äÇ œÉ</text>

      <text x="350" y="220" font-family="Source Sans 3" font-size="10.5" fill="#2a2520" text-anchor="middle">œÑ is <tspan font-style="italic">incident</tspan> to œÉ</text>
      <text x="350" y="240" font-family="Source Sans 3" font-size="10.5" fill="#2a2520" text-anchor="middle">(œÑ is on œÉ's boundary)</text>
      <text x="350" y="275" font-family="JetBrains Mono" font-size="10" fill="#2a6b5a" text-anchor="middle">B_{k,k+1} matrix</text>
      <text x="350" y="295" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">boundary: rank k+1 ‚Üí rank k</text>
      <text x="350" y="310" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">coboundary: rank k ‚Üí rank k+1</text>

      <!-- Type 3: Upper/Lower adjacency via shared higher/lower cell -->
      <rect x="475" y="10" width="210" height="320" rx="8" fill="white" stroke="#d5d0c8"/>
      <text x="580" y="38" font-family="Source Sans 3" font-size="12" font-weight="700" fill="#8b5a8c" text-anchor="middle">Upper/Lower Adjacency</text>
      <text x="580" y="56" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" text-anchor="middle">Same rank, share a higher cell</text>

      <!-- Three edges that share a common face -->
      <polygon points="520,140 620,110 600,200" fill="#c8a8d0" fill-opacity="0.15" stroke="#8b5a8c" stroke-width="1" stroke-dasharray="4,3"/>
      <line x1="520" y1="140" x2="620" y2="110" stroke="#2a6b5a" stroke-width="2.5"/>
      <line x1="620" y1="110" x2="600" y2="200" stroke="#2a6b5a" stroke-width="2.5"/>
      <line x1="600" y1="200" x2="520" y2="140" stroke="#2a6b5a" stroke-width="2.5"/>
      <circle cx="520" cy="140" r="6" class="node-v" stroke-width="1.5"/>
      <circle cx="620" cy="110" r="6" class="node-v" stroke-width="1.5"/>
      <circle cx="600" cy="200" r="6" class="node-v" stroke-width="1.5"/>
      <text x="565" y="115" font-family="Source Sans 3" font-size="9" fill="#2a6b5a" font-weight="600">e‚ÇÅ</text>
      <text x="620" y="160" font-family="Source Sans 3" font-size="9" fill="#2a6b5a" font-weight="600">e‚ÇÇ</text>
      <text x="555" y="180" font-family="Source Sans 3" font-size="9" fill="#2a6b5a" font-weight="600">e‚ÇÉ</text>

      <path d="M 560,120 C 575,100 595,108 615,125" stroke="#8b5a8c" stroke-width="1.5" fill="none" stroke-dasharray="4,3"/>

      <text x="580" y="225" font-family="Source Sans 3" font-size="10.5" fill="#2a2520" text-anchor="middle">e‚ÇÅ and e‚ÇÇ are <tspan font-style="italic">upper-adjacent</tspan></text>
      <text x="580" y="245" font-family="Source Sans 3" font-size="10.5" fill="#2a2520" text-anchor="middle">(both rank 1, co-faces of œÉ)</text>
      <text x="580" y="275" font-family="JetBrains Mono" font-size="10" fill="#8b5a8c" text-anchor="middle">coA_{k,k} = B¬∑B·µÄ</text>
      <text x="580" y="295" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">Lower adj: share a face</text>
      <text x="580" y="310" font-family="Source Sans 3" font-size="10" fill="#6b6560" text-anchor="middle">Upper adj: share a coface</text>

      <!-- Arrow markers -->
      <defs>
        <marker id="arrow-red" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
          <path d="M 0 0 L 10 5 L 0 10 z" fill="#b44a2f"/>
        </marker>
        <marker id="arrow-green" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
          <path d="M 0 0 L 10 5 L 0 10 z" fill="#2a6b5a"/>
        </marker>
      </defs>
    </svg>
    <div class="caption"><strong>Figure 7.1.</strong> Three types of adjacency in a topological domain. <strong>Co-adjacency</strong> (same rank, shared lower cell) generalizes the graph adjacency matrix. <strong>Incidence</strong> (cross-rank containment) captures the boundary/coboundary relationship. <strong>Upper/lower adjacency</strong> (same rank, shared higher/lower cell) enables message passing mediated by higher-order context.</div>
  </div>

  <h3>The Neighborhood Matrix Zoo</h3>
  <p>For a CC with ranks 0, 1, ..., $K$, the paper defines a rich set of matrices encoding different neighborhood relations. The most important ones:</p>

  <table class="comp-table">
    <thead>
      <tr><th>Matrix</th><th>Dimension</th><th>Meaning</th></tr>
    </thead>
    <tbody>
      <tr>
        <td>$\mathbf{B}_{k,k+1}$</td>
        <td>$|\mathcal{X}_k| \times |\mathcal{X}_{k+1}|$</td>
        <td>Incidence: which $k$-cells are on the boundary of which $(k\!+\!1)$-cells</td>
      </tr>
      <tr>
        <td>$\mathbf{A}_{k,\downarrow} = \mathbf{B}_{k-1,k}^\top \mathbf{B}_{k-1,k}$</td>
        <td>$|\mathcal{X}_k| \times |\mathcal{X}_k|$</td>
        <td>Lower adjacency: $k$-cells sharing a $(k\!-\!1)$-cell boundary</td>
      </tr>
      <tr>
        <td>$\mathbf{A}_{k,\uparrow} = \mathbf{B}_{k,k+1} \mathbf{B}_{k,k+1}^\top$</td>
        <td>$|\mathcal{X}_k| \times |\mathcal{X}_k|$</td>
        <td>Upper adjacency: $k$-cells sharing a $(k\!+\!1)$-cell coface</td>
      </tr>
    </tbody>
  </table>

  <div class="insight">
    <p><strong>Standard graph adjacency is a special case.</strong> The usual graph adjacency matrix $\mathbf{A}$ is the upper adjacency of rank-0 cells (vertices) via rank-1 cells (edges): $\mathbf{A} = \mathbf{A}_{0,\uparrow} = \mathbf{B}_{0,1}\mathbf{B}_{0,1}^\top$. The entire GNN framework operates with just this one matrix. Topological deep learning opens up all the others.</p>
  </div>
</section>

<hr class="divider">

<!-- ============================================================ -->
<!-- SECTION 8 -->
<!-- ============================================================ -->
<hr class="divider">
<section id="sec8">
  <h2><span class="sec-num">08</span>Higher-Order Message Passing</h2>

  <p>
    With the neighborhood structure defined, we can now write down the general message-passing scheme on a CC. This is the paper's main contribution: a <strong>unified framework</strong> for updating features on cells of any rank, using messages from cells of any rank.
  </p>

  <h3>The General Update Rule</h3>
  <p>
    For a rank-$k$ cell $x$, the update at layer $\ell$ aggregates messages from multiple neighborhood types:
  </p>

  <div class="math-block">
    <div class="math-label">Higher-Order Message Passing (HOMP)</div>
    $$\mathbf{h}_x^{(k, \ell+1)} = \text{AGG}\!\left(\mathbf{h}_x^{(k,\ell)}, \;\; \bigoplus_{\mathcal{N} \in \{\mathcal{N}_\downarrow, \mathcal{N}_\uparrow, \mathcal{N}_{\text{adj}}, \mathcal{N}_{\text{inc}}\}} \bigoplus_{y \in \mathcal{N}(x)} m_\mathcal{N}\!\left(\mathbf{h}_x^{(k,\ell)},\, \mathbf{h}_y^{(r_y, \ell)}\right)\right)$$
  </div>

  <p>where the neighborhoods include:</p>

  <div class="figure">
    <svg viewBox="0 0 700 300" width="700" height="300">
      <!-- Central cell -->
      <rect x="280" y="120" width="140" height="50" rx="8" fill="#e8a88a" fill-opacity="0.4" stroke="#b44a2f" stroke-width="2"/>
      <text x="350" y="150" font-family="Source Sans 3" font-size="12" font-weight="700" fill="#b44a2f" text-anchor="middle">Cell x (rank k)</text>

      <!-- Lower cells (rank k-1) -->
      <rect x="50" y="220" width="130" height="40" rx="6" fill="#8ec5b6" fill-opacity="0.3" stroke="#2a6b5a" stroke-width="1.5"/>
      <text x="115" y="245" font-family="Source Sans 3" font-size="11" fill="#2a6b5a" text-anchor="middle" font-weight="600">Boundary (rank k‚àí1)</text>
      <path d="M 115,220 Q 150,180 280,145" stroke="#2a6b5a" stroke-width="1.5" fill="none" marker-end="url(#arrow-green)"/>
      <text x="170" y="175" font-family="Source Sans 3" font-size="10" fill="#2a6b5a" font-weight="600">ùí©‚Üì</text>

      <!-- Upper cells (rank k+1) -->
      <rect x="50" y="20" width="130" height="40" rx="6" fill="#a8c0e0" fill-opacity="0.3" stroke="#3a5a8c" stroke-width="1.5"/>
      <text x="115" y="45" font-family="Source Sans 3" font-size="11" fill="#3a5a8c" text-anchor="middle" font-weight="600">Cofaces (rank k+1)</text>
      <path d="M 115,60 Q 150,100 280,140" stroke="#3a5a8c" stroke-width="1.5" fill="none" marker-end="url(#arrow-green)"/>
      <text x="170" y="105" font-family="Source Sans 3" font-size="10" fill="#3a5a8c" font-weight="600">ùí©‚Üë</text>

      <!-- Same-rank neighbors (lower adj) -->
      <rect x="520" y="50" width="150" height="40" rx="6" fill="#c8a8d0" fill-opacity="0.3" stroke="#8b5a8c" stroke-width="1.5"/>
      <text x="595" y="75" font-family="Source Sans 3" font-size="11" fill="#8b5a8c" text-anchor="middle" font-weight="600">Lower-adj (rank k)</text>
      <path d="M 520,70 Q 470,90 420,135" stroke="#8b5a8c" stroke-width="1.5" fill="none" marker-end="url(#arrow-green)"/>
      <text x="480" y="95" font-family="Source Sans 3" font-size="10" fill="#8b5a8c" font-weight="600">ùí©adj,‚Üì</text>

      <!-- Same-rank neighbors (upper adj) -->
      <rect x="520" y="200" width="150" height="40" rx="6" fill="#e8d8a8" fill-opacity="0.4" stroke="#8b7a3c" stroke-width="1.5"/>
      <text x="595" y="225" font-family="Source Sans 3" font-size="11" fill="#8b7a3c" text-anchor="middle" font-weight="600">Upper-adj (rank k)</text>
      <path d="M 520,220 Q 470,190 420,160" stroke="#8b7a3c" stroke-width="1.5" fill="none" marker-end="url(#arrow-green)"/>
      <text x="480" y="195" font-family="Source Sans 3" font-size="10" fill="#8b7a3c" font-weight="600">ùí©adj,‚Üë</text>

      <!-- Legend bar -->
      <rect x="100" y="275" width="500" height="22" rx="4" fill="#f8f4ee" stroke="#d5d0c8"/>
      <text x="350" y="291" font-family="Source Sans 3" font-size="10.5" fill="#6b6560" text-anchor="middle">Each arrow represents a separate message-passing channel with its own learnable parameters</text>
    </svg>
    <div class="caption"><strong>Figure 8.1.</strong> A rank-$k$ cell receives messages from four types of neighborhoods: boundary cells (rank $k\!-\!1$), coface cells (rank $k\!+\!1$), lower-adjacent same-rank cells (sharing a boundary cell), and upper-adjacent same-rank cells (sharing a coface). Each channel has independent learnable weights.</div>
  </div>

  <h3>In Matrix Form</h3>
  <p>
    For a full layer operating on all rank-$k$ cells simultaneously, the update takes an elegant matrix form. Here's the simplified version for a rank-$k$ cochain $\mathbf{H}^{(k)}$:
  </p>

  <div class="math-block">
    <div class="math-label">Matrix form of one message-passing channel</div>
    $$\mathbf{H}^{(k, \ell+1)} = \sigma\!\left(\mathbf{A}_{k,\downarrow}\, \mathbf{H}^{(k,\ell)}\, \mathbf{W}_{\downarrow}^{(\ell)} + \mathbf{A}_{k,\uparrow}\, \mathbf{H}^{(k,\ell)}\, \mathbf{W}_{\uparrow}^{(\ell)} + \mathbf{B}_{k,k+1}\, \mathbf{H}^{(k+1,\ell)}\, \mathbf{W}_{\text{inc}}^{(\ell)} + \mathbf{H}^{(k,\ell)}\, \mathbf{W}_{\text{self}}^{(\ell)}\right)$$
  </div>

  <p>
    This should look familiar ‚Äî it's a direct generalization of the GCN update $\mathbf{H}^{(\ell+1)} = \sigma(\hat{\mathbf{A}}\mathbf{H}^{(\ell)}\mathbf{W}^{(\ell)})$, but now with <em>multiple adjacency matrices</em> operating across multiple ranks.
  </p>

  <div class="insight key">
    <p><strong>The key structural insight:</strong> In a standard GNN, information can only flow along edges (rank 1). In HOMP, information flows <em>up</em> (from boundaries to volumes), <em>down</em> (from volumes to boundaries), and <em>laterally</em> (between same-rank cells that share higher or lower cells). This enables the network to capture multi-scale, multi-resolution physics natively.</p>
  </div>
</section>

<hr class="divider">

<!-- ============================================================ -->
<!-- SECTION 9 -->
<!-- ============================================================ -->
<div class="footer-nav"><a href="tdl-05-complexes.html"><span class="dir">‚Üê Previous</span><span class="title">Simplicial, Cell & Combinatorial Complexes</span></a><a class="next" href="tdl-07-architectures.html"><span class="dir">Next ‚Üí</span><span class="title">Hodge Theory & the Architecture Zoo</span></a></div>
</main>
<footer><p><a href="tdl-index.html">‚Üê Course Home</a> ¬∑ <a href="index.html">All Notes</a></p></footer>
</body>
</html>